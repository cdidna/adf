{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "CDI-Hub-ADF-p01"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_QUALITY_WSSI_D')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "식품의약품안전처(식품위해정보)\n회수.판매중지 정보",
				"activities": [
					{
						"name": "ForEach API data",
						"description": "cdi-root / 품질/외부/식품위해관리/회수판매중지정보 위치에 항목별로 복사합니다.",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "ORA GET CNT",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "API GET CNT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@range(\n    1\n    ,add(\n        div(\n            sub(\n                activity('API GET CNT').output.firstRow.I0490.total_count\n                ,int(activity('ORA GET CNT').output.firstRow.total_cnt)\n            )\n            , 1000\n        )\n        ,if(\n            greater(\n                mod(\n                    sub(\n                        activity('API GET CNT').output.firstRow.I0490.total_count\n                        ,int(activity('ORA GET CNT').output.firstRow.total_cnt)\n                    )\n                    , 1000\n                )\n                , 0\n            )\n            , 1\n            , 0\n        )\n    )\n)",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "API REQ_copy",
									"description": "각 API 호출",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set endIndex",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "XmlSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET"
											},
											"formatSettings": {
												"type": "XmlReadSettings",
												"validationMode": "none",
												"namespaces": true
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['RTRVLPLANDOC_RTRVLMTHD']"
													},
													"sink": {
														"name": "RTRVLPLANDOC_RTRVLMTHD",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_CD']"
													},
													"sink": {
														"name": "PRDLST_CD",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RTRVLPRVNS']"
													},
													"sink": {
														"name": "RTRVLPRVNS",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['FRMLCUNIT']"
													},
													"sink": {
														"name": "FRMLCUNIT",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_REPORT_NO']"
													},
													"sink": {
														"name": "PRDLST_REPORT_NO",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CRET_DTM']"
													},
													"sink": {
														"name": "CRET_DTM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['LCNS_NO']"
													},
													"sink": {
														"name": "LCNS_NO",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DISTBTMLMT']"
													},
													"sink": {
														"name": "DISTBTMLMT",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_TYPE']"
													},
													"sink": {
														"name": "PRDLST_TYPE",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ADDR']"
													},
													"sink": {
														"name": "ADDR",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRCDNO']"
													},
													"sink": {
														"name": "BRCDNO",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['IMG_FILE_PATH']"
													},
													"sink": {
														"name": "IMG_FILE_PATH",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MNFDT']"
													},
													"sink": {
														"name": "MNFDT",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDTNM']"
													},
													"sink": {
														"name": "PRDTNM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_CD_NM']"
													},
													"sink": {
														"name": "PRDLST_CD_NM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BSSHNM']"
													},
													"sink": {
														"name": "BSSHNM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRCSCITYPOINT_TELNO']"
													},
													"sink": {
														"name": "PRCSCITYPOINT_TELNO",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RTRVLDSUSE_SEQ']"
													},
													"sink": {
														"name": "RTRVLDSUSE_SEQ",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RTRVL_GRDCD_NM']"
													},
													"sink": {
														"name": "RTRVL_GRDCD_NM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['@id']"
													},
													"sink": {
														"name": "RowId",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['I0490']['total_count']"
													},
													"sink": {
														"name": "total_count",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['I0490']['row']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_DITBCD_SRC",
											"type": "DatasetReference",
											"parameters": {
												"ApiKey": {
													"value": "@pipeline().parameters.Apikey",
													"type": "Expression"
												},
												"StartIdx": {
													"value": "@variables('startIdx')",
													"type": "Expression"
												},
												"EndIdx": {
													"value": "@variables('endIdx')",
													"type": "Expression"
												},
												"ServiceId": {
													"value": "@pipeline().parameters.ServiceId",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'))",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat(pipeline().parameters.FileName, '_', replace(variables('endIdx') , '/', '_'),'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'), '.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Set startIdx",
									"description": "시 인덱스 값을 정의한다.",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "startIdx",
										"value": {
											"value": "@string(sub(\n    add(\n        int(activity('ORA GET CNT').output.firstRow.total_cnt)\n        , add(mul(1000, item()), 1)\n    )\n, 1000))",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set endIndex",
									"description": "종료 인덱스 값을 정의한다.",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set startIdx",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "endIdx",
										"value": {
											"value": "@string(add(\n    int(variables('startIdx'))\n    , if(\n        greater(\n            sub(\n                activity('API GET CNT').output.firstRow.I0490.total_count\n                , int(variables('startIdx'))\n            )\n            , 1000\n        )\n        , 999\n        , sub(\n            activity('API GET CNT').output.firstRow.I0490.total_count\n            , int(variables('startIdx'))\n        )\n    )\n))",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Insert Sequence",
									"description": "cd_if.cd_fdsfty_seq 값 Insert",
									"type": "Script",
									"dependsOn": [
										{
											"activity": "API REQ_copy",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"linkedServiceName": {
										"referenceName": "LKS_ORA_P01",
										"type": "LinkedServiceReference"
									},
									"typeProperties": {
										"scripts": [
											{
												"type": "Query",
												"text": {
													"value": "INSERT INTO cd_if.cd_fdsfty_seq (type, row_id, qty, crt_dt, crt_user) \nVALUES (\n  '@{pipeline().parameters.ServiceId}'\n  , (SELECT NVL(MAX(row_id), 0) + 1 FROM cd_if.cd_fdsfty_seq WHERE type = '@{pipeline().parameters.ServiceId}')\n  , '@{variables('endIdx')}'\n  , to_char(sysdate, 'yyyymmddhhmiss')\n, 'system'\n);",
													"type": "Expression"
												}
											}
										],
										"scriptBlockExecutionTimeout": "02:00:00"
									}
								}
							]
						}
					},
					{
						"name": "Merge Data",
						"description": "cdi-root /품질/외부/식품위해관리/ 위치에 항목별로 복사합니다.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach API data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"maxConcurrentConnections": 1,
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'))",
										"type": "Expression"
									},
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"maxConcurrentConnections": 1,
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 1,
							"enableSkipIncompatibleRow": true,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_', formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'),'.csv')\n\n",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ORA GET CNT",
						"description": "저장된 값의 Total 값을 확인하기 위해 DB조",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "@concat('SELECT NVL(max(qty), 0) as total_cnt FROM cd_if.cd_fdsfty_seq WHERE type = ''', pipeline().parameters.ServiceId, ''' ORDER BY row_id DESC ')",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": "1",
									"SourceTable": "1"
								}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "API GET CNT",
						"description": "API의 총 건 수를 확인하기 위해 API 1회 호출.",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "XmlSource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET"
								},
								"formatSettings": {
									"type": "XmlReadSettings",
									"validationMode": "none",
									"detectDataType": true,
									"namespaces": true
								}
							},
							"dataset": {
								"referenceName": "DTS_API_DITBCD_SRC",
								"type": "DatasetReference",
								"parameters": {
									"ApiKey": "@pipeline().parameters.Apikey",
									"StartIdx": "1",
									"EndIdx": "1",
									"ServiceId": "@pipeline().parameters.ServiceId"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "품질/외부/식품위해관리"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "회수판매중지정보"
					},
					"AdlsDirectoryConf": {
						"type": "string",
						"defaultValue": "품질/외부/식품위해관리/conf"
					},
					"ConfFile": {
						"type": "string",
						"defaultValue": "회수판매중지정보Index"
					},
					"AdlsDirectoryOri": {
						"type": "string",
						"defaultValue": "품질/외부/식품위해관리/회수판매중지정보"
					},
					"Apikey": {
						"type": "string",
						"defaultValue": "f93320322b05463499de"
					},
					"ServiceId": {
						"type": "string",
						"defaultValue": "I0490"
					}
				},
				"variables": {
					"startIdx": {
						"type": "String"
					},
					"endIdx": {
						"type": "String"
					}
				},
				"folder": {
					"name": "품질/외부/식품위해관리"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-15T12:48:09Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_QUALITY_WSSI_D_V2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "식품의약품안전처(식품위해정보)\n회수.판매중지 정보",
				"activities": [
					{
						"name": "ForEach API data",
						"description": "cdi-root / 품질/외부/식품위해관리/회수판매중지정보 위치에 항목별로 복사합니다.",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "API GET CNT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@range(\n    0, \n    add(\n        div(\n            activity('API GET CNT').output.firstRow.I0490.total_count\n            ,1000\n        )\n        , 1\n    )\n)",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "API REQ_copy",
									"description": "각 API 호출",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set endIndex",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "XmlSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET"
											},
											"formatSettings": {
												"type": "XmlReadSettings",
												"validationMode": "none",
												"namespaces": true
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['RTRVLPLANDOC_RTRVLMTHD']"
													},
													"sink": {
														"name": "RTRVLPLANDOC_RTRVLMTHD",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_CD']"
													},
													"sink": {
														"name": "PRDLST_CD",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RTRVLPRVNS']"
													},
													"sink": {
														"name": "RTRVLPRVNS",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['FRMLCUNIT']"
													},
													"sink": {
														"name": "FRMLCUNIT",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_REPORT_NO']"
													},
													"sink": {
														"name": "PRDLST_REPORT_NO",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CRET_DTM']"
													},
													"sink": {
														"name": "CRET_DTM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['LCNS_NO']"
													},
													"sink": {
														"name": "LCNS_NO",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DISTBTMLMT']"
													},
													"sink": {
														"name": "DISTBTMLMT",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_TYPE']"
													},
													"sink": {
														"name": "PRDLST_TYPE",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ADDR']"
													},
													"sink": {
														"name": "ADDR",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRCDNO']"
													},
													"sink": {
														"name": "BRCDNO",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['IMG_FILE_PATH']"
													},
													"sink": {
														"name": "IMG_FILE_PATH",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MNFDT']"
													},
													"sink": {
														"name": "MNFDT",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDTNM']"
													},
													"sink": {
														"name": "PRDTNM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_CD_NM']"
													},
													"sink": {
														"name": "PRDLST_CD_NM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BSSHNM']"
													},
													"sink": {
														"name": "BSSHNM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRCSCITYPOINT_TELNO']"
													},
													"sink": {
														"name": "PRCSCITYPOINT_TELNO",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RTRVLDSUSE_SEQ']"
													},
													"sink": {
														"name": "RTRVLDSUSE_SEQ",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RTRVL_GRDCD_NM']"
													},
													"sink": {
														"name": "RTRVL_GRDCD_NM",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['@id']"
													},
													"sink": {
														"name": "RowId",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['I0490']['total_count']"
													},
													"sink": {
														"name": "total_count",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['I0490']['row']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_DITBCD_SRC",
											"type": "DatasetReference",
											"parameters": {
												"ApiKey": {
													"value": "@pipeline().parameters.Apikey",
													"type": "Expression"
												},
												"StartIdx": {
													"value": "@variables('startIdx')",
													"type": "Expression"
												},
												"EndIdx": {
													"value": "@variables('endIdx')",
													"type": "Expression"
												},
												"ServiceId": {
													"value": "@pipeline().parameters.ServiceId",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'))",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat(pipeline().parameters.FileName, '_', replace(variables('endIdx') , '/', '_'),'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'), '.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Set startIdx",
									"description": "시 인덱스 값을 정의한다.\n",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "startIdx",
										"value": {
											"value": "@string(\n    add(\n        0\n        , mul(\n            item()\n            , 1000\n        )\n    )\n)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set endIndex",
									"description": "종료 인덱스 값을 정의한다.",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set startIdx",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "endIdx",
										"value": {
											"value": "@string(\n    if( \n        and(\n            lessOrEquals(\n                0\n                , sub(\n                    mul(\n                        add(item(), 1)\n                        , 1000\n                    )\n                    , activity('API GET CNT').output.firstRow.I0490.total_count\n                )\n            )\n            , greaterOrEquals(\n                1000\n                , sub(\n                    mul(\n                        add(item(), 1)\n                        , 1000\n                    )\n                    , activity('API GET CNT').output.firstRow.I0490.total_count\n                )\n            )\n        )\n        , activity('API GET CNT').output.firstRow.I0490.total_count        \n        , mul(\n            add(\n                item()\n                , 1\n            )\n            , 1000\n        )\n    )\n)",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Merge Data",
						"description": "cdi-root /품질/외부/식품위해관리/ 위치에 항목별로 복사합니다.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach API data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"maxConcurrentConnections": 1,
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'))",
										"type": "Expression"
									},
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"maxConcurrentConnections": 1,
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 1,
							"enableSkipIncompatibleRow": true,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_', formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'),'.csv')\n\n",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "API GET CNT",
						"description": "API의 총 건 수를 확인하기 위해 API 1회 호출.",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "XmlSource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET"
								},
								"formatSettings": {
									"type": "XmlReadSettings",
									"validationMode": "none",
									"detectDataType": true,
									"namespaces": true
								}
							},
							"dataset": {
								"referenceName": "DTS_API_DITBCD_SRC",
								"type": "DatasetReference",
								"parameters": {
									"ApiKey": "@pipeline().parameters.Apikey",
									"StartIdx": "1",
									"EndIdx": "1",
									"ServiceId": "@pipeline().parameters.ServiceId"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "품질/외부/식품위해관리"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "회수판매중지정보"
					},
					"AdlsDirectoryConf": {
						"type": "string",
						"defaultValue": "품질/외부/식품위해관리/conf"
					},
					"ConfFile": {
						"type": "string",
						"defaultValue": "회수판매중지정보Index"
					},
					"AdlsDirectoryOri": {
						"type": "string",
						"defaultValue": "품질/외부/식품위해관리/회수판매중지정보"
					},
					"Apikey": {
						"type": "string",
						"defaultValue": "f93320322b05463499de"
					},
					"ServiceId": {
						"type": "string",
						"defaultValue": "I0490"
					}
				},
				"variables": {
					"startIdx": {
						"type": "String"
					},
					"endIdx": {
						"type": "String"
					}
				},
				"folder": {
					"name": "품질/외부/식품위해관리"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-03T05:16:03Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_DM_PT_HOME_DATA_FULL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Execute_SP",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select cd_mart.func_dm_pt_home_data();",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							}
						}
					},
					{
						"name": "Execute_SP_copy1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Execute_SP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select cd_mart.func_dm_fm_association_frequency();",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "데이터마트"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-12T02:58:16Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_DM_SL_DOCUMENT_JWBO_REVIEW_FULL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "JWES_REVIEW_PG",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_SNK_PG_JWRS_CONTENTS",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {
										"SinkSchema": "cd_mart",
										"SinkTable": "dm_sl_documents_summary_t"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "BESTON_REVIEW_PG",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_SNK_PG_BO_CONTENTS",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {
										"SinkSchema": "cd_mart",
										"SinkTable": "dm_sl_documents_summary_t"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "데이터마트"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T04:43:11Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_DM_SL_DOCUMENT_SOCIAL_OPINION_FULL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DOCUMENT_BLOG",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ADLS_PG_CUSTOMER_OPINION_BLOG_FULL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {
										"SinkSchema": "@concat(pipeline().parameters.SinkSchema)",
										"SinkTable": "@concat(pipeline().parameters.SinkTable)"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DOCUMENT_COMM",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ADLS_PG_CUSTOMER_OPINION_COMM_FULL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {
										"SinkSchema": "@concat(pipeline().parameters.SinkSchema)",
										"SinkTable": "@concat(pipeline().parameters.SinkTable)"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DOCUMENT_INSTA",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ADLS_PG_CUSTOMER_OPINION_INSTA_FULL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {
										"SinkSchema": "@concat(pipeline().parameters.SinkSchema)",
										"SinkTable": "@concat(pipeline().parameters.SinkTable)"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DOCUMENT_NEWS",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ADLS_PG_CUSTOMER_OPINION_NEWS_FULL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {
										"SinkSchema": "@concat(pipeline().parameters.SinkSchema)",
										"SinkTable": "@concat(pipeline().parameters.SinkTable)"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DOCUMENT_TWITTER",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ADLS_PG_CUSTOMER_OPINION_TWITTER_FULL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {
										"SinkSchema": "@concat(pipeline().parameters.SinkSchema)",
										"SinkTable": "@concat(pipeline().parameters.SinkTable)"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DOCUMENT_YOUTUBE",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ADLS_PG_CUSTOMER_OPINION_YOUTUBE_FULL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {
										"SinkSchema": "@concat(pipeline().parameters.SinkSchema)",
										"SinkTable": "@concat(pipeline().parameters.SinkTable)"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_mart"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "dm_sl_documents_summary_t"
					}
				},
				"folder": {
					"name": "데이터마트"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-12T03:00:19Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_DM_SL_DOCUMENT_SUMMARY_REVIEW_FULL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "store review",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ADLS_PG_STORE_REVIEW_M",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {
										"SinkSchema": "@concat(pipeline().parameters.SinkSchema)",
										"SinkTable": "@concat(pipeline().parameters.SinkTable)"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_mart"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "dm_sl_doc_summary_t"
					}
				},
				"folder": {
					"name": "데이터마트"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-12T02:58:16Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_DDREAM_POS_DD_SALES_FULL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lookup Date",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "@concat('SELECT DISTINCT(SUBSTR(', pipeline().parameters.IncCol, ', 1, 6)) CALMONTH FROM ', pipeline().parameters.SourceSchema, '.', pipeline().parameters.SourceTable)",
									"type": "Expression"
								},
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup Date').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy data All Month",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "@concat('SELECT * FROM ', pipeline().parameters.SourceSchema, '.', pipeline().parameters.SourceTable, ' WHERE SUBSTR(',pipeline().parameters.IncCol, ', 1, 6) = ', item().CALMONTH)",
												"type": "Expression"
											},
											"partitionOption": "None",
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_ORACLE_SRC",
											"type": "DatasetReference",
											"parameters": {
												"SourceSchema": {
													"value": "@pipeline().parameters.SourceSchema",
													"type": "Expression"
												},
												"SourceTable": {
													"value": "@pipeline().parameters.SourceTable",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@pipeline().parameters.AdlsDirectory",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_',item().CALMONTH,'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_DDREAM"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "POS_DD_SALES"
					},
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "매출(주문)/외부/유통사MS정보/데이터드"
					},
					"IncCol": {
						"type": "string",
						"defaultValue": "SALES_DATE"
					}
				},
				"folder": {
					"name": "매출_주문/외부/데이터드림"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-15T05:56:40Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_DDREAM_POS_DD_SALES_INC_ADLS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data Previous Month",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Delete Previous Month",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_DDREAM.POS_DD_SALES\n WHERE SALES_DATE >= TO_CHAR(TRUNC(ADD_MONTHS(SYSDATE,-1), 'MM'),'YYYYMMDD')\n   AND SALES_DATE <= TO_CHAR(LAST_DAY(TRUNC(ADD_MONTHS(SYSDATE,-1), 'MM')),'YYYYMMDD');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_', addToTime(addHours(utcNow(), 9), -1, 'Month','yyyyMM'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy data Current Month",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Delete Current Month",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_DDREAM.POS_DD_SALES\n WHERE SALES_DATE >= TO_CHAR(TRUNC(SYSDATE, 'MM'),'YYYYMMDD')\n   AND SALES_DATE <= TO_CHAR(TRUNC(SYSDATE-1),'YYYYMMDD');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMM'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Delete Current Month",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": "@pipeline().parameters.AdlsDirectory",
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_', formatDateTime(addHours(utcNow(), 9),'yyyyMM'), '.csv')",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"fileListPath": {
									"value": "@pipeline().parameters.AdlsDirectory",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Delete Previous Month",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": "@pipeline().parameters.AdlsDirectory",
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_', addToTime(addHours(utcNow(), 9),-1,'Month', 'yyyyMM'), '.csv')",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"fileListPath": {
									"value": "@pipeline().parameters.AdlsDirectory",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_DDREAM"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "POS_DD_SALES"
					},
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "매출(주문)/외부/유통사MS정보"
					}
				},
				"variables": {
					"prev_start": {
						"type": "String",
						"defaultValue": "@startOfMonth(addToTime(addHours(utcNow(), 9), -1, 'Month'), 'yyyyMMdd')"
					},
					"prev_end": {
						"type": "String",
						"defaultValue": "@adddays(startOfMonth(addHours(utcNow(), 9)), -1, 'yyyyMMdd')"
					}
				},
				"folder": {
					"name": "매출_주문/외부/데이터드림"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T04:36:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_DDREAM_POS_DD_SALES_INC_PG')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lookup API Info",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "select to_char(min(base_date),'YYYYMMDD') AS SDATE\n         ,to_char(MAX(base_date),'YYYYMMDD') AS EDATE\n    from cd_ods.aps_sdc_pw_mst\n   where CMONTH2 between to_char(add_months(sysdate,-1),'YYYYMM') AND TO_CHAR(SYSDATE,'YYYYMM')\n   GROUP BY CMONTH2\n   ORDER BY CMONTH2\n  ",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": "@pipeline().parameters.SourceSchema",
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup API Info",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup API Info').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy data1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "SELECT *\n FROM CD_DDREAM.POS_DD_SALES\nWHERE SALES_DATE BETWEEN '@{item().SDATE}' AND '@{item().EDATE}'\n           ",
												"type": "Expression"
											},
											"partitionOption": "None",
											"convertDecimalToInteger": false,
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"preCopyScript": {
												"value": "DELETE\n    FROM CD_ODS.POS_DD_SALES\n    WHERE SALES_DATE BETWEEN  '@{item().SDATE}' AND '@{item().EDATE}'",
												"type": "Expression"
											},
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "SALES_DATE",
														"type": "String"
													},
													"sink": {
														"name": "sales_date",
														"type": "String",
														"physicalType": "character varying"
													}
												},
												{
													"source": {
														"name": "DRIM_STORE_ID",
														"type": "String"
													},
													"sink": {
														"name": "drim_store_id",
														"type": "String",
														"physicalType": "character varying"
													}
												},
												{
													"source": {
														"name": "BARCODE_NO",
														"type": "String"
													},
													"sink": {
														"name": "barcode_no",
														"type": "String",
														"physicalType": "character varying"
													}
												},
												{
													"source": {
														"name": "SALES_CNT",
														"type": "Double"
													},
													"sink": {
														"name": "sales_cnt",
														"type": "Decimal",
														"physicalType": "numeric"
													}
												},
												{
													"source": {
														"name": "SALES_AMT",
														"type": "Double"
													},
													"sink": {
														"name": "sales_amt",
														"type": "Decimal",
														"physicalType": "numeric"
													}
												},
												{
													"source": {
														"name": "REGI_DATE",
														"type": "String"
													},
													"sink": {
														"name": "regi_date",
														"type": "String",
														"physicalType": "character varying"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_ORACLE_SRC",
											"type": "DatasetReference",
											"parameters": {
												"SourceSchema": {
													"value": "@pipeline().parameters.SourceSchema",
													"type": "Expression"
												},
												"SourceTable": {
													"value": "@pipeline().parameters.SourceTable",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": {
													"value": "@pipeline().parameters.SinkSchema",
													"type": "Expression"
												},
												"SinkTable": {
													"value": "@pipeline().parameters.SinkTable",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Execute_SP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": "select cd_mart.func_dm_pr_datadream_summary();",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_DDREAM"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "POS_DD_SALES"
					},
					"SinkSchema": {
						"type": "string",
						"defaultValue": "CD_ODS"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "POS_DD_SALES"
					}
				},
				"variables": {
					"prev_start": {
						"type": "String",
						"defaultValue": "@startOfMonth(addToTime(addHours(utcNow(), 9), -1, 'Month'), 'yyyyMMdd')"
					},
					"prev_end": {
						"type": "String",
						"defaultValue": "@adddays(startOfMonth(addHours(utcNow(), 9)), -1, 'yyyyMMdd')"
					}
				},
				"folder": {
					"name": "매출_주문/외부/데이터드림"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T02:10:16Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_DWRS_SC_EVENT_PLAN_COMPLETE_FULL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lookup Date",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "@concat('SELECT DISTINCT(SUBSTR(', pipeline().parameters.IncCol, ', 1, 6)) CALMONTH FROM ', pipeline().parameters.SourceSchema, '.', pipeline().parameters.SourceTable)",
									"type": "Expression"
								},
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup Date').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy data All Month",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "@concat('SELECT * FROM ', pipeline().parameters.SourceSchema, '.', pipeline().parameters.SourceTable, ' WHERE SUBSTR(',pipeline().parameters.IncCol, ', 1, 6) = ', item().CALMONTH)",
												"type": "Expression"
											},
											"partitionOption": "None",
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_ORACLE_SRC",
											"type": "DatasetReference",
											"parameters": {
												"SourceSchema": {
													"value": "@pipeline().parameters.SourceSchema",
													"type": "Expression"
												},
												"SourceTable": {
													"value": "@pipeline().parameters.SourceTable",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@pipeline().parameters.AdlsDirectory",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_',item().CALMONTH,'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_DWRS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "SC_EVENT_PLAN_COMPLETE"
					},
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "판촉/내부/판촉관리정보"
					},
					"IncCol": {
						"type": "string",
						"defaultValue": "EVENT_DATE"
					}
				},
				"folder": {
					"name": "판촉/내부/판촉관리"
				},
				"annotations": [],
				"lastPublishTime": "2022-10-20T05:52:22Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_DWRS_SC_EVENT_PLAN_COMPLETE_INC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data Previous Month",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Delete Previous Month",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_DWRS.SC_EVENT_PLAN_COMPLETE\n WHERE EVENT_DATE >= TO_CHAR(TRUNC(ADD_MONTHS(SYSDATE,-1), 'MM'),'YYYYMMDD')\n   AND EVENT_DATE <= TO_CHAR(LAST_DAY(TRUNC(ADD_MONTHS(SYSDATE,-1), 'MM')),'YYYYMMDD');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_', addToTime(addHours(utcNow(), 9), -1, 'Month','yyyyMM'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy data Current Month",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Delete Current Month",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_DWRS.SC_EVENT_PLAN_COMPLETE\n WHERE EVENT_DATE >= TO_CHAR(TRUNC(SYSDATE, 'MM'),'YYYYMMDD')\n   AND EVENT_DATE <= TO_CHAR(TRUNC(SYSDATE-1),'YYYYMMDD');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMM'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Delete Current Month",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": "@pipeline().parameters.AdlsDirectory",
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_', formatDateTime(addHours(utcNow(), 9),'yyyyMM'), '.csv')",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"fileListPath": {
									"value": "@pipeline().parameters.AdlsDirectory",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Delete Previous Month",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": "@pipeline().parameters.AdlsDirectory",
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_', addToTime(addHours(utcNow(), 9),-1,'Month', 'yyyyMM'), '.csv')",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"fileListPath": {
									"value": "@pipeline().parameters.AdlsDirectory",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_DWRS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "SC_EVENT_PLAN_COMPLETE"
					},
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "판촉/내부/판촉관리정보"
					}
				},
				"variables": {
					"prev_start": {
						"type": "String",
						"defaultValue": "@startOfMonth(addToTime(addHours(utcNow(), 9), -1, 'Month'), 'yyyyMMdd')"
					},
					"prev_end": {
						"type": "String",
						"defaultValue": "@adddays(startOfMonth(addHours(utcNow(), 9)), -1, 'yyyyMMdd')"
					}
				},
				"folder": {
					"name": "판촉/내부/판촉관리"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-15T11:46:34Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_NEIS_NEIS_MEALS_NEW_FULL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "- 초기 적재시, 월별로 모든 파일 Sink\n- 증분컬럼이 YYYYMM 형태",
				"activities": [
					{
						"name": "Lookup Date",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "@concat('SELECT DISTINCT(', pipeline().parameters.IncCol, ') AS CALMONTH FROM ', pipeline().parameters.SourceSchema, '.', pipeline().parameters.SourceTable)",
									"type": "Expression"
								},
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup Date').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy data All Month",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "@concat('SELECT * FROM ', pipeline().parameters.SourceSchema, '.', pipeline().parameters.SourceTable, ' WHERE ', pipeline().parameters.IncCol, ' = ', item().CALMONTH)",
												"type": "Expression"
											},
											"partitionOption": "None",
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_ORACLE_SRC",
											"type": "DatasetReference",
											"parameters": {
												"SourceSchema": {
													"value": "@pipeline().parameters.SourceSchema",
													"type": "Expression"
												},
												"SourceTable": {
													"value": "@pipeline().parameters.SourceTable",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@pipeline().parameters.AdlsDirectory",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_',item().CALMONTH,'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_NEIS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "NEIS_MEALS_NEW"
					},
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "판촉/내부/학교급식_식단정보"
					},
					"IncCol": {
						"type": "string",
						"defaultValue": "YYYYMM"
					}
				},
				"folder": {
					"name": "판촉/내부/급식입개찰"
				},
				"annotations": [],
				"lastPublishTime": "2022-10-18T08:30:36Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_NEIS_NEIS_MEALS_NEW_FULL_PG')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "- 초기 적재시, 월별로 모든 파일 Sink\n- 증분컬럼이 YYYYMM 형태",
				"activities": [
					{
						"name": "Lookup Date",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "@concat('SELECT DISTINCT(', pipeline().parameters.IncCol, ') AS CALMONTH FROM ', pipeline().parameters.SourceSchema, '.', pipeline().parameters.SourceTable)",
									"type": "Expression"
								},
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"dataset": {
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup Date').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy data All Month",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"oracleReaderQuery": {
												"value": "@concat('SELECT * FROM ', pipeline().parameters.SourceSchema, '.', pipeline().parameters.SourceTable, ' WHERE ', pipeline().parameters.IncCol, ' = ', item().CALMONTH)",
												"type": "Expression"
											},
											"partitionOption": "None",
											"queryTimeout": "02:00:00"
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"preCopyScript": {
												"value": "delete from cd_ods.neis_meals_new  \t\t\nwhere YYYYMM = '@{item().calmonth}'",
												"type": "Expression"
											},
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "YYYYMMDD"
													},
													"sink": {
														"name": "yyyymmdd"
													}
												},
												{
													"source": {
														"name": "YYYY"
													},
													"sink": {
														"name": "yyyy"
													}
												},
												{
													"source": {
														"name": "YYYYMM"
													},
													"sink": {
														"name": "yyyymm"
													}
												},
												{
													"source": {
														"name": "ATPT_OFCDC_SC_CODE"
													},
													"sink": {
														"name": "atpt_ofcdc_sc_code"
													}
												},
												{
													"source": {
														"name": "SCHUL_NM"
													},
													"sink": {
														"name": "schul_nm"
													}
												},
												{
													"source": {
														"name": "SD_SCHUL_CODE"
													},
													"sink": {
														"name": "sd_schul_code"
													}
												},
												{
													"source": {
														"name": "MEALS_CODE"
													},
													"sink": {
														"name": "meals_code"
													}
												},
												{
													"source": {
														"name": "MLSV_FGR"
													},
													"sink": {
														"name": "mlsv_fgr"
													}
												},
												{
													"source": {
														"name": "MEALS"
													},
													"sink": {
														"name": "meals"
													}
												},
												{
													"source": {
														"name": "MEAL_CONTEXT"
													},
													"sink": {
														"name": "meal_context"
													}
												},
												{
													"source": {
														"name": "REG_DATE"
													},
													"sink": {
														"name": "reg_date"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_ORACLE_SRC",
											"type": "DatasetReference",
											"parameters": {
												"SourceSchema": {
													"value": "@pipeline().parameters.SourceSchema",
													"type": "Expression"
												},
												"SourceTable": {
													"value": "@pipeline().parameters.SourceTable",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK_P02",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "neis_meals_new"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_NEIS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "NEIS_MEALS_NEW"
					},
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "판촉/내부/학교급식_식단정보"
					},
					"IncCol": {
						"type": "string",
						"defaultValue": "YYYYMM"
					}
				},
				"folder": {
					"name": "판촉/내부/급식입개찰"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-03T01:31:00Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_NEIS_NEIS_MEALS_NEW_INC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "- 증분 적재시, 전달+현재 달 파일 Delete후 새로 생성\n- 증분컬럼이 YYYYMM 형태\n- Copy data Current Month > Source > Query 변경 필요\n- Copy data Previous Month > Source > Query 변경 필요",
				"activities": [
					{
						"name": "Copy data Next Month",
						"description": "익월 데이터 추가",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Delete Next Month",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_NEIS.NEIS_MEALS_NEW\n WHERE YYYYMM = TO_CHAR(TRUNC(ADD_MONTHS(SYSDATE,1), 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_', addToTime(addHours(utcNow(), 9), 1, 'Month','yyyyMM'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy data Current Month",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Delete Current Month",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_NEIS.NEIS_MEALS_NEW\n WHERE YYYYMM = TO_CHAR(TRUNC(SYSDATE, 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMM'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Delete Current Month",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": "@pipeline().parameters.AdlsDirectory",
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_', formatDateTime(addHours(utcNow(), 9),'yyyyMM'), '.csv')",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"fileListPath": {
									"value": "@pipeline().parameters.AdlsDirectory",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "Delete Next Month",
						"description": "익월 내용 삭",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": "@pipeline().parameters.AdlsDirectory",
									"FileName": {
										"value": "@concat('D_', pipeline().parameters.SourceSchema,'.', pipeline().parameters.SourceTable,'_', addToTime(addHours(utcNow(), 9),1,'Month', 'yyyyMM'), '.csv')",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"fileListPath": {
									"value": "@pipeline().parameters.AdlsDirectory",
									"type": "Expression"
								},
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_NEIS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "NEIS_MEALS_NEW"
					},
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "판촉/내부/학교급식_식단정보"
					}
				},
				"folder": {
					"name": "판촉/내부/급식입개찰"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-05T05:55:36Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_NEIS_NEIS_MEALS_NEW_INC_PG')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "- 증분 적재시, 전달+현재 달 파일 Delete후 새로 생성\n- 증분컬럼이 YYYYMM 형태\n- Copy data Current Month > Source > Query 변경 필요\n- Copy data Previous Month > Source > Query 변경 필요",
				"activities": [
					{
						"name": "Copy data Next Month",
						"description": "익월 데이터 추가",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_NEIS.NEIS_MEALS_NEW\n WHERE YYYYMM = TO_CHAR(TRUNC(ADD_MONTHS(SYSDATE,1), 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "delete \nfrom cd_ods.neis_meals_new\nwhere YYYYMM = to_char(date_trunc('month', current_timestamp + interval '9 hours' + interval '1 months'), 'YYYYMM');",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "YYYYMMDD"
										},
										"sink": {
											"name": "yyyymmdd"
										}
									},
									{
										"source": {
											"name": "YYYY"
										},
										"sink": {
											"name": "yyyy"
										}
									},
									{
										"source": {
											"name": "YYYYMM"
										},
										"sink": {
											"name": "yyyymm"
										}
									},
									{
										"source": {
											"name": "ATPT_OFCDC_SC_CODE"
										},
										"sink": {
											"name": "atpt_ofcdc_sc_code"
										}
									},
									{
										"source": {
											"name": "SCHUL_NM"
										},
										"sink": {
											"name": "schul_nm"
										}
									},
									{
										"source": {
											"name": "SD_SCHUL_CODE"
										},
										"sink": {
											"name": "sd_schul_code"
										}
									},
									{
										"source": {
											"name": "MEALS_CODE"
										},
										"sink": {
											"name": "meals_code"
										}
									},
									{
										"source": {
											"name": "MLSV_FGR"
										},
										"sink": {
											"name": "mlsv_fgr"
										}
									},
									{
										"source": {
											"name": "MEALS"
										},
										"sink": {
											"name": "meals"
										}
									},
									{
										"source": {
											"name": "MEAL_CONTEXT"
										},
										"sink": {
											"name": "meal_context"
										}
									},
									{
										"source": {
											"name": "REG_DATE"
										},
										"sink": {
											"name": "reg_date"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK_P02",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "cd_ods",
									"SinkTable": "neis_meals_new"
								}
							}
						]
					},
					{
						"name": "Copy data Current Month",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data Next Month",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_NEIS.NEIS_MEALS_NEW\n WHERE YYYYMM = TO_CHAR(TRUNC(SYSDATE, 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "delete \nfrom cd_ods.neis_meals_new\nwhere YYYYMM = to_char(date_trunc('month', current_timestamp + interval '9 hours'), 'YYYYMM');",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "YYYYMMDD"
										},
										"sink": {
											"name": "yyyymmdd"
										}
									},
									{
										"source": {
											"name": "YYYY"
										},
										"sink": {
											"name": "yyyy"
										}
									},
									{
										"source": {
											"name": "YYYYMM"
										},
										"sink": {
											"name": "yyyymm"
										}
									},
									{
										"source": {
											"name": "SCHUL_NM"
										},
										"sink": {
											"name": "schul_nm"
										}
									},
									{
										"source": {
											"name": "SD_SCHUL_CODE"
										},
										"sink": {
											"name": "sd_schul_code"
										}
									},
									{
										"source": {
											"name": "MEALS_CODE"
										},
										"sink": {
											"name": "meals_code"
										}
									},
									{
										"source": {
											"name": "MLSV_FGR"
										},
										"sink": {
											"name": "mlsv_fgr"
										}
									},
									{
										"source": {
											"name": "MEALS"
										},
										"sink": {
											"name": "meals"
										}
									},
									{
										"source": {
											"name": "MEAL_CONTEXT"
										},
										"sink": {
											"name": "meal_context"
										}
									},
									{
										"source": {
											"name": "REG_DATE"
										},
										"sink": {
											"name": "reg_date"
										}
									},
									{
										"source": {
											"name": "ATPT_OFCDC_SC_CODE"
										},
										"sink": {
											"name": "atpt_ofcdc_sc_code"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK_P02",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "cd_ods",
									"SinkTable": "neis_meals_new"
								}
							}
						]
					},
					{
						"name": "Execute_SP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data Current Month",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select cd_mart.func_dm_fm_school_food_frequency();",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_NEIS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "NEIS_MEALS_NEW"
					},
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "판촉/내부/학교급식_식단정보"
					}
				},
				"folder": {
					"name": "판촉/내부/급식입개찰"
				},
				"annotations": [],
				"lastPublishTime": "2023-02-01T05:04:36Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_ODS_BW_AZEP_O00000_FULL_FULL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "@{concat('truncate table ',pipeline().parameters.SinkSchema,'.',pipeline().parameters.SinkTable,';')}",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "COMP_CODE",
											"type": "String"
										},
										"sink": {
											"name": "comp_code",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String"
										},
										"sink": {
											"name": "calmonth",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALWEEK",
											"type": "String"
										},
										"sink": {
											"name": "calweek",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALDAY",
											"type": "String"
										},
										"sink": {
											"name": "calday",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String"
										},
										"sink": {
											"name": "salesorg",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String"
										},
										"sink": {
											"name": "distr_chan",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String"
										},
										"sink": {
											"name": "material",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String"
										},
										"sink": {
											"name": "customer",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZBOX",
											"type": "Decimal"
										},
										"sink": {
											"name": "zbox",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZEA",
											"type": "Decimal"
										},
										"sink": {
											"name": "zea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZKG",
											"type": "Decimal"
										},
										"sink": {
											"name": "zkg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "SALES_DIST",
											"type": "String"
										},
										"sink": {
											"name": "sales_dist",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUST_GROUP",
											"type": "String"
										},
										"sink": {
											"name": "cust_group",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_OFF",
											"type": "String"
										},
										"sink": {
											"name": "sales_off",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_GRP",
											"type": "String"
										},
										"sink": {
											"name": "sales_grp",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZAMT",
											"type": "String"
										},
										"sink": {
											"name": "zamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZVAL_RET",
											"type": "Decimal"
										},
										"sink": {
											"name": "zval_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZINVCDAMT",
											"type": "Double"
										},
										"sink": {
											"name": "zinvcdamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUWAVWR",
											"type": "Double"
										},
										"sink": {
											"name": "zguwavwr",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRVTT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrvtt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "COMP_CODE_KTL",
											"type": "String"
										},
										"sink": {
											"name": "comp_code_ktl",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZMKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zmkzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "REG_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "reg_date",
											"type": "DateTime",
											"physicalType": "timestamp without time zone"
										}
									},
									{
										"source": {
											"name": "ZBAEBU",
											"type": "String"
										},
										"sink": {
											"name": "zbaebu",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZSTPRS",
											"type": "Double"
										},
										"sink": {
											"name": "zstprs",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZQTY_RET",
											"type": "Double"
										},
										"sink": {
											"name": "zqty_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String"
										},
										"sink": {
											"name": "base_uom",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "NT_WT_KG",
											"type": "Double"
										},
										"sink": {
											"name": "nt_wt_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "PRICE_STD",
											"type": "Double"
										},
										"sink": {
											"name": "price_std",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_VAL",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_val",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zret_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zret_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zret_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRLAT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrlat",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": {
										"value": "@pipeline().parameters.SinkSchema",
										"type": "Expression"
									},
									"SinkTable": {
										"value": "@pipeline().parameters.SinkTable",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_ODS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "BW_AZEP_O00000_FULL"
					},
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "bw_azep_o00000_full"
					}
				},
				"folder": {
					"name": "매출_주문/내부/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2022-10-20T07:08:24Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_ODS_BW_AZEP_O00000_FULL_FULL_SAMPLE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "- 초기 적재시, 월별로 모든 파일 Sink\n",
				"activities": [
					{
						"name": "Copy data",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None",
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "@{concat('truncate table ',pipeline().parameters.SinkSchema,'.',pipeline().parameters.SinkTable,';')}",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "COMP_CODE",
											"type": "String"
										},
										"sink": {
											"name": "comp_code",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String"
										},
										"sink": {
											"name": "calmonth",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALWEEK",
											"type": "String"
										},
										"sink": {
											"name": "calweek",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALDAY",
											"type": "String"
										},
										"sink": {
											"name": "calday",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String"
										},
										"sink": {
											"name": "salesorg",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String"
										},
										"sink": {
											"name": "distr_chan",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String"
										},
										"sink": {
											"name": "material",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String"
										},
										"sink": {
											"name": "customer",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZBOX",
											"type": "Decimal"
										},
										"sink": {
											"name": "zbox",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZEA",
											"type": "Decimal"
										},
										"sink": {
											"name": "zea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZKG",
											"type": "Decimal"
										},
										"sink": {
											"name": "zkg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "SALES_DIST",
											"type": "String"
										},
										"sink": {
											"name": "sales_dist",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUST_GROUP",
											"type": "String"
										},
										"sink": {
											"name": "cust_group",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_OFF",
											"type": "String"
										},
										"sink": {
											"name": "sales_off",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_GRP",
											"type": "String"
										},
										"sink": {
											"name": "sales_grp",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZAMT",
											"type": "String"
										},
										"sink": {
											"name": "zamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZVAL_RET",
											"type": "Decimal"
										},
										"sink": {
											"name": "zval_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZINVCDAMT",
											"type": "Double"
										},
										"sink": {
											"name": "zinvcdamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUWAVWR",
											"type": "Double"
										},
										"sink": {
											"name": "zguwavwr",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRVTT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrvtt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "COMP_CODE_KTL",
											"type": "String"
										},
										"sink": {
											"name": "comp_code_ktl",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZMKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zmkzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "REG_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "reg_date",
											"type": "DateTime",
											"physicalType": "timestamp without time zone"
										}
									},
									{
										"source": {
											"name": "ZBAEBU",
											"type": "String"
										},
										"sink": {
											"name": "zbaebu",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZSTPRS",
											"type": "Double"
										},
										"sink": {
											"name": "zstprs",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZQTY_RET",
											"type": "Double"
										},
										"sink": {
											"name": "zqty_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String"
										},
										"sink": {
											"name": "base_uom",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "NT_WT_KG",
											"type": "Double"
										},
										"sink": {
											"name": "nt_wt_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "PRICE_STD",
											"type": "Double"
										},
										"sink": {
											"name": "price_std",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_VAL",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_val",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zret_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zret_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zret_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRLAT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrlat",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": {
										"value": "@pipeline().parameters.SinkSchema",
										"type": "Expression"
									},
									"SinkTable": {
										"value": "@pipeline().parameters.SinkTable",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_ODS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "BW_AZEP_O00000_FULL"
					},
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "bw_azep_o00000_full"
					}
				},
				"folder": {
					"name": "_Sample/DB/증분/ODS/증분컬럼: CHAR(YYYYMM)"
				},
				"annotations": [],
				"lastPublishTime": "2022-10-25T08:15:19Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_ODS_BW_AZEP_O00000_FULL_INC')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data Previous Month",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_ODS.BW_AZEP_O00000_FULL\n WHERE CALMONTH = TO_CHAR(TRUNC(ADD_MONTHS(SYSDATE,-1), 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "delete \nfrom cd_ods.bw_azep_o00000_full \nwhere calday between to_char(date_trunc('month', current_timestamp + interval '9 hours' - interval '1 months'), 'YYYYMMDD')\n                 and  to_char(date_trunc('month', current_timestamp + interval '9 hours' - interval '0 months') - interval '1 day', 'YYYYMMDD');",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "COMP_CODE",
											"type": "String"
										},
										"sink": {
											"name": "comp_code",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String"
										},
										"sink": {
											"name": "calmonth",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALWEEK",
											"type": "String"
										},
										"sink": {
											"name": "calweek",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALDAY",
											"type": "String"
										},
										"sink": {
											"name": "calday",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String"
										},
										"sink": {
											"name": "salesorg",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String"
										},
										"sink": {
											"name": "distr_chan",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String"
										},
										"sink": {
											"name": "material",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String"
										},
										"sink": {
											"name": "customer",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZBOX",
											"type": "Decimal"
										},
										"sink": {
											"name": "zbox",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZEA",
											"type": "Decimal"
										},
										"sink": {
											"name": "zea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZKG",
											"type": "Decimal"
										},
										"sink": {
											"name": "zkg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "SALES_DIST",
											"type": "String"
										},
										"sink": {
											"name": "sales_dist",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUST_GROUP",
											"type": "String"
										},
										"sink": {
											"name": "cust_group",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_OFF",
											"type": "String"
										},
										"sink": {
											"name": "sales_off",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_GRP",
											"type": "String"
										},
										"sink": {
											"name": "sales_grp",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZAMT",
											"type": "String"
										},
										"sink": {
											"name": "zamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZVAL_RET",
											"type": "Decimal"
										},
										"sink": {
											"name": "zval_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZINVCDAMT",
											"type": "Double"
										},
										"sink": {
											"name": "zinvcdamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUWAVWR",
											"type": "Double"
										},
										"sink": {
											"name": "zguwavwr",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRVTT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrvtt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "COMP_CODE_KTL",
											"type": "String"
										},
										"sink": {
											"name": "comp_code_ktl",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZMKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zmkzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "REG_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "reg_date",
											"type": "DateTime",
											"physicalType": "timestamp without time zone"
										}
									},
									{
										"source": {
											"name": "ZBAEBU",
											"type": "String"
										},
										"sink": {
											"name": "zbaebu",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZSTPRS",
											"type": "Double"
										},
										"sink": {
											"name": "zstprs",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZQTY_RET",
											"type": "Double"
										},
										"sink": {
											"name": "zqty_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String"
										},
										"sink": {
											"name": "base_uom",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "NT_WT_KG",
											"type": "Double"
										},
										"sink": {
											"name": "nt_wt_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "PRICE_STD",
											"type": "Double"
										},
										"sink": {
											"name": "price_std",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_VAL",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_val",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zret_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zret_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zret_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRLAT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrlat",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": {
										"value": "@pipeline().parameters.SinkSchema",
										"type": "Expression"
									},
									"SinkTable": {
										"value": "@pipeline().parameters.SinkTable",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy data Current Month",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data Previous Month",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_ODS.BW_AZEP_O00000_FULL\n WHERE CALMONTH = TO_CHAR(TRUNC(SYSDATE, 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "delete \nfrom cd_ods.bw_azep_o00000_full \nwhere calday  between to_char(date_trunc('month', current_timestamp + interval '9 hours' ), 'YYYYMMDD')\n                  and to_char(date_trunc('month', current_timestamp + interval '9 hours' + interval '1 months') - interval '1 day', 'YYYYMMDD');",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "COMP_CODE",
											"type": "String"
										},
										"sink": {
											"name": "comp_code",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String"
										},
										"sink": {
											"name": "calmonth",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALWEEK",
											"type": "String"
										},
										"sink": {
											"name": "calweek",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALDAY",
											"type": "String"
										},
										"sink": {
											"name": "calday",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String"
										},
										"sink": {
											"name": "salesorg",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String"
										},
										"sink": {
											"name": "distr_chan",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String"
										},
										"sink": {
											"name": "material",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String"
										},
										"sink": {
											"name": "customer",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZBOX",
											"type": "Decimal"
										},
										"sink": {
											"name": "zbox",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZEA",
											"type": "Decimal"
										},
										"sink": {
											"name": "zea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZKG",
											"type": "Decimal"
										},
										"sink": {
											"name": "zkg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "SALES_DIST",
											"type": "String"
										},
										"sink": {
											"name": "sales_dist",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUST_GROUP",
											"type": "String"
										},
										"sink": {
											"name": "cust_group",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_OFF",
											"type": "String"
										},
										"sink": {
											"name": "sales_off",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_GRP",
											"type": "String"
										},
										"sink": {
											"name": "sales_grp",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZAMT",
											"type": "String"
										},
										"sink": {
											"name": "zamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZVAL_RET",
											"type": "Decimal"
										},
										"sink": {
											"name": "zval_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZINVCDAMT",
											"type": "Double"
										},
										"sink": {
											"name": "zinvcdamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUWAVWR",
											"type": "Double"
										},
										"sink": {
											"name": "zguwavwr",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRVTT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrvtt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "COMP_CODE_KTL",
											"type": "String"
										},
										"sink": {
											"name": "comp_code_ktl",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZMKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zmkzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "REG_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "reg_date",
											"type": "DateTime",
											"physicalType": "timestamp without time zone"
										}
									},
									{
										"source": {
											"name": "ZBAEBU",
											"type": "String"
										},
										"sink": {
											"name": "zbaebu",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZSTPRS",
											"type": "Double"
										},
										"sink": {
											"name": "zstprs",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZQTY_RET",
											"type": "Double"
										},
										"sink": {
											"name": "zqty_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String"
										},
										"sink": {
											"name": "base_uom",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "NT_WT_KG",
											"type": "Double"
										},
										"sink": {
											"name": "nt_wt_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "PRICE_STD",
											"type": "Double"
										},
										"sink": {
											"name": "price_std",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_VAL",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_val",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zret_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zret_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zret_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRLAT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrlat",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": {
										"value": "@pipeline().parameters.SinkSchema",
										"type": "Expression"
									},
									"SinkTable": {
										"value": "@pipeline().parameters.SinkTable",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Execute_SP",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy data Current Month",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": "select cd_mart.func_dm_pr_sales_summary();",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_ODS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "BW_AZEP_O00000_FULL"
					},
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "bw_azep_o00000_full"
					}
				},
				"folder": {
					"name": "매출_주문/내부/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-12T01:54:03Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_ODS_BW_AZEP_O00000_FULL_INC_221111')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data Previous Month",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_ODS.BW_AZEP_O00000_FULL\n WHERE CALMONTH = TO_CHAR(TRUNC(ADD_MONTHS(SYSDATE,-1), 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "delete \nfrom cd_ods.bw_azep_o00000_full \nwhere calmonth = to_char(date_trunc('month', current_date - interval '1 months'), 'YYYYMM');",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "COMP_CODE",
											"type": "String"
										},
										"sink": {
											"name": "comp_code",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String"
										},
										"sink": {
											"name": "calmonth",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALWEEK",
											"type": "String"
										},
										"sink": {
											"name": "calweek",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALDAY",
											"type": "String"
										},
										"sink": {
											"name": "calday",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String"
										},
										"sink": {
											"name": "salesorg",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String"
										},
										"sink": {
											"name": "distr_chan",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String"
										},
										"sink": {
											"name": "material",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String"
										},
										"sink": {
											"name": "customer",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZBOX",
											"type": "Decimal"
										},
										"sink": {
											"name": "zbox",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZEA",
											"type": "Decimal"
										},
										"sink": {
											"name": "zea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZKG",
											"type": "Decimal"
										},
										"sink": {
											"name": "zkg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "SALES_DIST",
											"type": "String"
										},
										"sink": {
											"name": "sales_dist",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUST_GROUP",
											"type": "String"
										},
										"sink": {
											"name": "cust_group",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_OFF",
											"type": "String"
										},
										"sink": {
											"name": "sales_off",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_GRP",
											"type": "String"
										},
										"sink": {
											"name": "sales_grp",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZAMT",
											"type": "String"
										},
										"sink": {
											"name": "zamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZVAL_RET",
											"type": "Decimal"
										},
										"sink": {
											"name": "zval_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZINVCDAMT",
											"type": "Double"
										},
										"sink": {
											"name": "zinvcdamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUWAVWR",
											"type": "Double"
										},
										"sink": {
											"name": "zguwavwr",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRVTT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrvtt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "COMP_CODE_KTL",
											"type": "String"
										},
										"sink": {
											"name": "comp_code_ktl",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZMKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zmkzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "REG_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "reg_date",
											"type": "DateTime",
											"physicalType": "timestamp without time zone"
										}
									},
									{
										"source": {
											"name": "ZBAEBU",
											"type": "String"
										},
										"sink": {
											"name": "zbaebu",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZSTPRS",
											"type": "Double"
										},
										"sink": {
											"name": "zstprs",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZQTY_RET",
											"type": "Double"
										},
										"sink": {
											"name": "zqty_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String"
										},
										"sink": {
											"name": "base_uom",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "NT_WT_KG",
											"type": "Double"
										},
										"sink": {
											"name": "nt_wt_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "PRICE_STD",
											"type": "Double"
										},
										"sink": {
											"name": "price_std",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_VAL",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_val",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zret_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zret_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zret_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRLAT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrlat",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": {
										"value": "@pipeline().parameters.SinkSchema",
										"type": "Expression"
									},
									"SinkTable": {
										"value": "@pipeline().parameters.SinkTable",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy data Current Month",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_ODS.BW_AZEP_O00000_FULL\n WHERE CALMONTH = TO_CHAR(TRUNC(SYSDATE, 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "delete \nfrom cd_ods.bw_azep_o00000_full \nwhere calmonth = to_char(date_trunc('month', current_date), 'YYYYMM');",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "COMP_CODE",
											"type": "String"
										},
										"sink": {
											"name": "comp_code",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String"
										},
										"sink": {
											"name": "calmonth",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALWEEK",
											"type": "String"
										},
										"sink": {
											"name": "calweek",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALDAY",
											"type": "String"
										},
										"sink": {
											"name": "calday",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String"
										},
										"sink": {
											"name": "salesorg",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String"
										},
										"sink": {
											"name": "distr_chan",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String"
										},
										"sink": {
											"name": "material",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String"
										},
										"sink": {
											"name": "customer",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZBOX",
											"type": "Decimal"
										},
										"sink": {
											"name": "zbox",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZEA",
											"type": "Decimal"
										},
										"sink": {
											"name": "zea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZKG",
											"type": "Decimal"
										},
										"sink": {
											"name": "zkg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "SALES_DIST",
											"type": "String"
										},
										"sink": {
											"name": "sales_dist",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUST_GROUP",
											"type": "String"
										},
										"sink": {
											"name": "cust_group",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_OFF",
											"type": "String"
										},
										"sink": {
											"name": "sales_off",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_GRP",
											"type": "String"
										},
										"sink": {
											"name": "sales_grp",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZAMT",
											"type": "String"
										},
										"sink": {
											"name": "zamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZVAL_RET",
											"type": "Decimal"
										},
										"sink": {
											"name": "zval_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZINVCDAMT",
											"type": "Double"
										},
										"sink": {
											"name": "zinvcdamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUWAVWR",
											"type": "Double"
										},
										"sink": {
											"name": "zguwavwr",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRVTT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrvtt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "COMP_CODE_KTL",
											"type": "String"
										},
										"sink": {
											"name": "comp_code_ktl",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZMKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zmkzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "REG_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "reg_date",
											"type": "DateTime",
											"physicalType": "timestamp without time zone"
										}
									},
									{
										"source": {
											"name": "ZBAEBU",
											"type": "String"
										},
										"sink": {
											"name": "zbaebu",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZSTPRS",
											"type": "Double"
										},
										"sink": {
											"name": "zstprs",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZQTY_RET",
											"type": "Double"
										},
										"sink": {
											"name": "zqty_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String"
										},
										"sink": {
											"name": "base_uom",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "NT_WT_KG",
											"type": "Double"
										},
										"sink": {
											"name": "nt_wt_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "PRICE_STD",
											"type": "Double"
										},
										"sink": {
											"name": "price_std",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_VAL",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_val",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zret_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zret_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zret_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRLAT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrlat",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": {
										"value": "@pipeline().parameters.SinkSchema",
										"type": "Expression"
									},
									"SinkTable": {
										"value": "@pipeline().parameters.SinkTable",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_ODS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "BW_AZEP_O00000_FULL"
					},
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "bw_azep_o00000_full"
					}
				},
				"folder": {
					"name": "_Old/매출_주문/내부/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2022-11-11T01:40:51Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_D_CD_ODS_BW_AZEP_O00000_FULL_INC_SAMPLE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "- 증분 적재시, 전달+현재 달 파일 Delete후 새로 생성(Copy Activity Sink에서 precopy script로 적용)\n\n- Copy data Current Month > Source > Query 변경 필요\n- Copy data Current Month > Sink > Precopy script 변경 필요\n- Copy data Previous Month > Source > Query 변경 필요\n- Copy data Previous Month > Sink > Precopy script 변경 필요",
				"activities": [
					{
						"name": "Copy data Previous Month",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_ODS.BW_AZEP_O00000_FULL\n WHERE CALMONTH = TO_CHAR(TRUNC(ADD_MONTHS(SYSDATE,-1), 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "delete \nfrom cd_ods.bw_azep_o00000_full \nwhere calmonth = to_char(date_trunc('month', current_date - interval '1 months'), 'YYYYMM');",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "COMP_CODE",
											"type": "String"
										},
										"sink": {
											"name": "comp_code",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String"
										},
										"sink": {
											"name": "calmonth",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALWEEK",
											"type": "String"
										},
										"sink": {
											"name": "calweek",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALDAY",
											"type": "String"
										},
										"sink": {
											"name": "calday",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String"
										},
										"sink": {
											"name": "salesorg",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String"
										},
										"sink": {
											"name": "distr_chan",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String"
										},
										"sink": {
											"name": "material",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String"
										},
										"sink": {
											"name": "customer",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZBOX",
											"type": "Decimal"
										},
										"sink": {
											"name": "zbox",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZEA",
											"type": "Decimal"
										},
										"sink": {
											"name": "zea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZKG",
											"type": "Decimal"
										},
										"sink": {
											"name": "zkg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "SALES_DIST",
											"type": "String"
										},
										"sink": {
											"name": "sales_dist",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUST_GROUP",
											"type": "String"
										},
										"sink": {
											"name": "cust_group",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_OFF",
											"type": "String"
										},
										"sink": {
											"name": "sales_off",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_GRP",
											"type": "String"
										},
										"sink": {
											"name": "sales_grp",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZAMT",
											"type": "String"
										},
										"sink": {
											"name": "zamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZVAL_RET",
											"type": "Decimal"
										},
										"sink": {
											"name": "zval_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZINVCDAMT",
											"type": "Double"
										},
										"sink": {
											"name": "zinvcdamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUWAVWR",
											"type": "Double"
										},
										"sink": {
											"name": "zguwavwr",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRVTT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrvtt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "COMP_CODE_KTL",
											"type": "String"
										},
										"sink": {
											"name": "comp_code_ktl",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZMKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zmkzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "REG_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "reg_date",
											"type": "DateTime",
											"physicalType": "timestamp without time zone"
										}
									},
									{
										"source": {
											"name": "ZBAEBU",
											"type": "String"
										},
										"sink": {
											"name": "zbaebu",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZSTPRS",
											"type": "Double"
										},
										"sink": {
											"name": "zstprs",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZQTY_RET",
											"type": "Double"
										},
										"sink": {
											"name": "zqty_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String"
										},
										"sink": {
											"name": "base_uom",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "NT_WT_KG",
											"type": "Double"
										},
										"sink": {
											"name": "nt_wt_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "PRICE_STD",
											"type": "Double"
										},
										"sink": {
											"name": "price_std",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_VAL",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_val",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zret_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zret_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zret_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRLAT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrlat",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": {
										"value": "@pipeline().parameters.SinkSchema",
										"type": "Expression"
									},
									"SinkTable": {
										"value": "@pipeline().parameters.SinkTable",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy data Current Month",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": {
									"value": "SELECT *\n  FROM CD_ODS.BW_AZEP_O00000_FULL\n WHERE CALMONTH = TO_CHAR(TRUNC(SYSDATE, 'MM'),'YYYYMM');",
									"type": "Expression"
								},
								"partitionOption": "None",
								"convertDecimalToInteger": false,
								"queryTimeout": "02:00:00"
							},
							"sink": {
								"type": "AzurePostgreSQLSink",
								"writeBatchSize": 1000000,
								"writeBatchTimeout": "00:30:00",
								"preCopyScript": {
									"value": "delete \nfrom cd_ods.bw_azep_o00000_full \nwhere calmonth = to_char(date_trunc('month', current_date), 'YYYYMM');",
									"type": "Expression"
								},
								"writeMethod": "CopyCommand"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "COMP_CODE",
											"type": "String"
										},
										"sink": {
											"name": "comp_code",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALMONTH",
											"type": "String"
										},
										"sink": {
											"name": "calmonth",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALWEEK",
											"type": "String"
										},
										"sink": {
											"name": "calweek",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CALDAY",
											"type": "String"
										},
										"sink": {
											"name": "calday",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALESORG",
											"type": "String"
										},
										"sink": {
											"name": "salesorg",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "DISTR_CHAN",
											"type": "String"
										},
										"sink": {
											"name": "distr_chan",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "MATERIAL",
											"type": "String"
										},
										"sink": {
											"name": "material",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUSTOMER",
											"type": "String"
										},
										"sink": {
											"name": "customer",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZBOX",
											"type": "Decimal"
										},
										"sink": {
											"name": "zbox",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZEA",
											"type": "Decimal"
										},
										"sink": {
											"name": "zea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZKG",
											"type": "Decimal"
										},
										"sink": {
											"name": "zkg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "SALES_DIST",
											"type": "String"
										},
										"sink": {
											"name": "sales_dist",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "CUST_GROUP",
											"type": "String"
										},
										"sink": {
											"name": "cust_group",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_OFF",
											"type": "String"
										},
										"sink": {
											"name": "sales_off",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "SALES_GRP",
											"type": "String"
										},
										"sink": {
											"name": "sales_grp",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZAMT",
											"type": "String"
										},
										"sink": {
											"name": "zamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZVAL_RET",
											"type": "Decimal"
										},
										"sink": {
											"name": "zval_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZINVCDAMT",
											"type": "Double"
										},
										"sink": {
											"name": "zinvcdamt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUWAVWR",
											"type": "Double"
										},
										"sink": {
											"name": "zguwavwr",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRVTT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrvtt",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "COMP_CODE_KTL",
											"type": "String"
										},
										"sink": {
											"name": "comp_code_ktl",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZGUKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zgukzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZMKZWI4",
											"type": "Double"
										},
										"sink": {
											"name": "zmkzwi4",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI2",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi2",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZUMKZWI3",
											"type": "Double"
										},
										"sink": {
											"name": "zumkzwi3",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "REG_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "reg_date",
											"type": "DateTime",
											"physicalType": "timestamp without time zone"
										}
									},
									{
										"source": {
											"name": "ZBAEBU",
											"type": "String"
										},
										"sink": {
											"name": "zbaebu",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "ZSTPRS",
											"type": "Double"
										},
										"sink": {
											"name": "zstprs",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZQTY_RET",
											"type": "Double"
										},
										"sink": {
											"name": "zqty_ret",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "BASE_UOM",
											"type": "String"
										},
										"sink": {
											"name": "base_uom",
											"type": "String",
											"physicalType": "character varying"
										}
									},
									{
										"source": {
											"name": "NT_WT_KG",
											"type": "Double"
										},
										"sink": {
											"name": "nt_wt_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_QTY",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_qty",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "PRICE_STD",
											"type": "Double"
										},
										"sink": {
											"name": "price_std",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "INVCD_VAL",
											"type": "Double"
										},
										"sink": {
											"name": "invcd_val",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zret_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zret_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRET_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zret_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHR_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zhr_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_EA",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_ea",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_KG",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_kg",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZRETID_BOX",
											"type": "Double"
										},
										"sink": {
											"name": "zretid_box",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									},
									{
										"source": {
											"name": "ZHRLAT",
											"type": "Double"
										},
										"sink": {
											"name": "zhrlat",
											"type": "Decimal",
											"physicalType": "numeric"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ORACLE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"SourceSchema": {
										"value": "@pipeline().parameters.SourceSchema",
										"type": "Expression"
									},
									"SourceTable": {
										"value": "@pipeline().parameters.SourceTable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": {
										"value": "@pipeline().parameters.SinkSchema",
										"type": "Expression"
									},
									"SinkTable": {
										"value": "@pipeline().parameters.SinkTable",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SourceSchema": {
						"type": "string",
						"defaultValue": "CD_ODS"
					},
					"SourceTable": {
						"type": "string",
						"defaultValue": "BW_AZEP_O00000_FULL"
					},
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "bw_azep_o00000_full"
					}
				},
				"folder": {
					"name": "_Sample/DB/증분/ODS/증분컬럼: CHAR(YYYYMM)"
				},
				"annotations": [],
				"lastPublishTime": "2022-10-25T08:15:19Z"
			},
			"dependsOn": []
		}
	]
}