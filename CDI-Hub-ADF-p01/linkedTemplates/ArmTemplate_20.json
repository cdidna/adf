{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory 이름",
			"defaultValue": "CDI-Hub-ADF-p01"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_DART_LIST')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "입찰공고목록 정보에 대한 물품조회",
				"activities": [
					{
						"name": "get page",
						"description": "대표 제품의 생성 기간동안 토탈 건수 ",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "set strdt",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "set enddt",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET"
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DTS_API_DART",
								"type": "DatasetReference",
								"parameters": {
									"url": {
										"value": "@concat('list.json?crtfc_key=6135b67dd87c31548f335ef7da9128534f1dac19&page_count=100&bgn_de=',variables('strdt'),'&end_de=',variables('enddt'))",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "get page",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@range(1  \n      ,add(\n             div(\n                  int(activity('get page').output.firstRow.total_count) \n                 ,int(pipeline().parameters.one_page_row)                  \n                )\n            ,if(\n                greater(\n                        mod(\n                            int(activity('get page').output.firstRow.total_count) \n                        ,int(pipeline().parameters.one_page_row)   \n                            )\n                       ,0\n                       )\n                ,1,0\n            )           \n       )\n)",
								"type": "Expression"
							},
							"batchCount": 20,
							"activities": [
								{
									"name": "Copy data1_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET"
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['corp_code']"
													},
													"sink": {
														"name": "corp_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['corp_name']"
													},
													"sink": {
														"name": "corp_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['stock_code']"
													},
													"sink": {
														"name": "stock_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['corp_cls']"
													},
													"sink": {
														"name": "corp_cls",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['report_nm']"
													},
													"sink": {
														"name": "report_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcept_no']"
													},
													"sink": {
														"name": "rcept_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['flr_nm']"
													},
													"sink": {
														"name": "flr_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcept_dt']"
													},
													"sink": {
														"name": "rcept_dt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rm']"
													},
													"sink": {
														"name": "rm",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['list']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_DART",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('list.json?crtfc_key=6135b67dd87c31548f335ef7da9128534f1dac19&page_count=100&bgn_de=',variables('strdt'),'&end_de=',variables('enddt'), '&page_no=',item())",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": {
													"value": "@pipeline().parameters.SinkSchema",
													"type": "Expression"
												},
												"SinkTable": {
													"value": "@pipeline().parameters.SinkTable",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "set strdt",
						"description": "당일자",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "strdt",
							"value": {
								"value": "@if(equals(pipeline().parameters.pipstrdt,null),formatDateTime(adddays(addHours(utcNow(), 9), -1), 'yyyyMMdd'),pipeline().parameters.pipstrdt)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "set enddt",
						"description": "당일자",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "enddt",
							"value": {
								"value": "@if(equals(pipeline().parameters.pipstrdt,null),formatDateTime(adddays(addHours(utcNow(), 9), -1), 'yyyyMMdd'),pipeline().parameters.pipstrdt)",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "tb_dart_list_t"
					},
					"one_page_row": {
						"type": "string",
						"defaultValue": "100"
					},
					"pipstrdt": {
						"type": "string"
					},
					"pipenddt": {
						"type": "string"
					}
				},
				"variables": {
					"strdt": {
						"type": "String"
					},
					"enddt": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Industry/외부/전자공시시스템"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T07:55:39Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_DSPI')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "국내공급물가지수",
				"activities": [
					{
						"name": "API REQ INFO",
						"description": "API 호출 정보를 가져오기 위해 설정 파일에서 CATEGORY,CALLNAME을 읽어옵니다.",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectoryConf",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.ConfFile,'.csv')",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"description": "cdi-root / Industry / 외부 / 소비자_생산자물가지수 / 국내공급물가지수 / 위치에 항목별로 복사합니다.",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "API REQ INFO",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('API REQ INFO').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "API REQ",
									"description": "각 API 호출",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:07:00",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['STAT_CODE']"
													},
													"sink": {
														"name": "STAT_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['STAT_NAME']"
													},
													"sink": {
														"name": "STAT_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_CODE1']"
													},
													"sink": {
														"name": "ITEM_CODE1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_NAME1']"
													},
													"sink": {
														"name": "ITEM_NAME1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_CODE2']"
													},
													"sink": {
														"name": "ITEM_CODE2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_NAME2']"
													},
													"sink": {
														"name": "ITEM_NAME2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_CODE3']"
													},
													"sink": {
														"name": "ITEM_CODE3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_NAME3']"
													},
													"sink": {
														"name": "ITEM_NAME3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_CODE4']"
													},
													"sink": {
														"name": "ITEM_CODE4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_NAME4']"
													},
													"sink": {
														"name": "ITEM_NAME4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UNIT_NAME']"
													},
													"sink": {
														"name": "UNIT_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TIME']"
													},
													"sink": {
														"name": "TIME",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_VALUE']"
													},
													"sink": {
														"name": "DATA_VALUE",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['StatisticSearch']['list_total_count']"
													},
													"sink": {
														"name": "list_total_count",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['StatisticSearch']['row']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_CPPI_SRC",
											"type": "DatasetReference",
											"parameters": {
												"Category": {
													"value": "@item().Category",
													"type": "Expression"
												},
												"ApiKey": {
													"value": "@pipeline().parameters.Apikey",
													"type": "Expression"
												},
												"StartYM": {
													"value": "@formatDateTime(addDays(addHours(utcNow(), 9), -1) , 'yyyyMM')",
													"type": "Expression"
												},
												"EndYM": {
													"value": "@formatDateTime(addDays(addHours(utcNow(), 9), -1) , 'yyyyMM')",
													"type": "Expression"
												},
												"StatisticsCD": {
													"value": "@pipeline().parameters.StatisticsCD",
													"type": "Expression"
												},
												"Category2": " ",
												"REQENDCNT": {
													"value": "@pipeline().parameters.ReqEndCnt",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyyMM'))",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat(pipeline().parameters.FileName, '_', replace(item().CallName, '/', '_'),'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'), '.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Merge Data",
						"description": "cdi-root / Industry / 외부 / 소비자_생산자물가지수 에 통합본을 저장합니다.\n",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach Copy data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"maxConcurrentConnections": 1,
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyyMM'))",
										"type": "Expression"
									},
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"maxConcurrentConnections": 1,
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 1,
							"enableSkipIncompatibleRow": true,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_', formatDateTime(addHours(utcNow(), 9), 'yyyyMM'),'.csv')\n\n",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "Industry/외부/소비자_생산자물가지수"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "국내공급물가지수"
					},
					"AdlsDirectoryConf": {
						"type": "string",
						"defaultValue": "Industry/외부/소비자_생산자물가지수/conf"
					},
					"ConfFile": {
						"type": "string",
						"defaultValue": "소비자_생산자물가지수_국내공급물가지수_conf"
					},
					"AdlsDirectoryOri": {
						"type": "string",
						"defaultValue": "Industry/외부/소비자_생산자물가지수/국내공급물가지수"
					},
					"Apikey": {
						"type": "string",
						"defaultValue": "UXAN20EQNBBR6N370MSJ"
					},
					"StatisticsCD": {
						"type": "string",
						"defaultValue": "405Y006"
					},
					"ReqEndCnt": {
						"type": "string",
						"defaultValue": "1000"
					}
				},
				"folder": {
					"name": "Industry/외부/소비자_생산자물가지수"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-19T08:35:41Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_DSPI_M')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "국내공급물가지수",
				"activities": [
					{
						"name": "API REQ INFO",
						"description": "API 호출 정보를 가져오기 위해 설정 파일에서 CATEGORY,CALLNAME을 읽어옵니다.",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectoryConf",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.ConfFile,'.csv')",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"description": "cdi-root / Industry / 외부 / 소비자_생산자물가지수 / 국내공급물가지수 / 위치에 항목별로 복사합니다.",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "API REQ INFO",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('API REQ INFO').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "API REQ",
									"description": "각 API 호출",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:07:00",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['STAT_CODE']"
													},
													"sink": {
														"name": "STAT_CODE",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['STAT_NAME']"
													},
													"sink": {
														"name": "STAT_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_CODE1']"
													},
													"sink": {
														"name": "ITEM_CODE1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_NAME1']"
													},
													"sink": {
														"name": "ITEM_NAME1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_CODE2']"
													},
													"sink": {
														"name": "ITEM_CODE2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_NAME2']"
													},
													"sink": {
														"name": "ITEM_NAME2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_CODE3']"
													},
													"sink": {
														"name": "ITEM_CODE3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_NAME3']"
													},
													"sink": {
														"name": "ITEM_NAME3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_CODE4']"
													},
													"sink": {
														"name": "ITEM_CODE4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ITEM_NAME4']"
													},
													"sink": {
														"name": "ITEM_NAME4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UNIT_NAME']"
													},
													"sink": {
														"name": "UNIT_NAME",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TIME']"
													},
													"sink": {
														"name": "TIME",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_VALUE']"
													},
													"sink": {
														"name": "DATA_VALUE",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['StatisticSearch']['list_total_count']"
													},
													"sink": {
														"name": "list_total_count",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['StatisticSearch']['row']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_CPPI_SRC",
											"type": "DatasetReference",
											"parameters": {
												"Category": {
													"value": "@item().Category",
													"type": "Expression"
												},
												"ApiKey": {
													"value": "@pipeline().parameters.Apikey",
													"type": "Expression"
												},
												"StartYM": {
													"value": "@pipeline().parameters.StartYM",
													"type": "Expression"
												},
												"EndYM": {
													"value": "@pipeline().parameters.EndYM",
													"type": "Expression"
												},
												"StatisticsCD": {
													"value": "@pipeline().parameters.StatisticsCD",
													"type": "Expression"
												},
												"Category2": " ",
												"REQENDCNT": {
													"value": "@pipeline().parameters.ReqEndCnt",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyyMM'))",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat(pipeline().parameters.FileName, '_', replace(item().CallName, '/', '_'),'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'), '.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Merge Data",
						"description": "cdi-root / Industry / 외부 / 소비자_생산자물가지수 에 통합본을 저장합니다.\n",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach Copy data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"maxConcurrentConnections": 1,
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyyMM'))",
										"type": "Expression"
									},
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"maxConcurrentConnections": 1,
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 1,
							"enableSkipIncompatibleRow": true,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_', formatDateTime(addHours(utcNow(), 9), 'yyyyMM'),'.csv')\n\n",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "Industry/외부/소비자_생산자물가지수"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "국내공급물가지수"
					},
					"AdlsDirectoryConf": {
						"type": "string",
						"defaultValue": "Industry/외부/소비자_생산자물가지수/conf"
					},
					"ConfFile": {
						"type": "string",
						"defaultValue": "소비자_생산자물가지수_국내공급물가지수_conf"
					},
					"AdlsDirectoryOri": {
						"type": "string",
						"defaultValue": "Industry/외부/소비자_생산자물가지수/국내공급물가지수"
					},
					"Apikey": {
						"type": "string",
						"defaultValue": "UXAN20EQNBBR6N370MSJ"
					},
					"StartYM": {
						"type": "string",
						"defaultValue": "202101"
					},
					"EndYM": {
						"type": "string",
						"defaultValue": "202206"
					},
					"StatisticsCD": {
						"type": "string",
						"defaultValue": "405Y006"
					},
					"ReqEndCnt": {
						"type": "string",
						"defaultValue": "1000"
					}
				},
				"folder": {
					"name": "Industry/외부/소비자_생산자물가지수"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-19T08:35:41Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FNB_ALL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "고도몰 증분",
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set yyyymm",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select '@{variables('yyyymm')}' as REQ_DATE, unnest(ARRAY[0,1,2]) as DATA_GBN\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "data copy",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_NAME']"
													},
													"sink": {
														"name": "brand_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['EL_PRICE']"
													},
													"sink": {
														"name": "el_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MI_PRICE']"
													},
													"sink": {
														"name": "mi_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['HI_PRICE']"
													},
													"sink": {
														"name": "hi_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ETC_PRICE']"
													},
													"sink": {
														"name": "etc_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_CODE']"
													},
													"sink": {
														"name": "brand_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BRAND_PRICE']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BRAND_PRICE&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_FNB_MONTH_BRAND_PRICE_t"
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Set yyyymm",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "yyyymm",
							"value": {
								"value": "@pipeline().parameters.pipyyyymm",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Lookup2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select BRAND_CODE as BRAND_CODE, '@{variables('yyyymm')}' as REQ_DATE, unnest(ARRAY[0,1,2,3,4,5]) as DATA_GBN \nfrom cd_ods.tb_fnb_month_brand_price_t\nwhere data_gbn = '0'\nand REQ_DATE = '@{variables('yyyymm')}'\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1_copy1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup2').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "data copy_copy1",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_NAME']"
													},
													"sink": {
														"name": "brand_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MP_NAME']"
													},
													"sink": {
														"name": "mp_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_CODE']"
													},
													"sink": {
														"name": "brand_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BRAND_TOP_PRODUCT']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BRAND_TOP_PRODUCT&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date,'&BRAND_CODE=',item().brand_code)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BRAND_TOP_PRODUCT_t"
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup3",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1_copy1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select BRAND_CODE as BRAND_CODE, '@{variables('yyyymm')}' as REQ_DATE, unnest(ARRAY[1,2]) as DATA_GBN \nfrom cd_ods.tb_fnb_month_brand_price_t\nwhere data_gbn = '0'\nand REQ_DATE = '@{variables('yyyymm')}'\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1_copy2",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup3').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "data copy_copy2",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_NAME']"
													},
													"sink": {
														"name": "brand_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA']"
													},
													"sink": {
														"name": "area",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA_SUB']"
													},
													"sink": {
														"name": "area_sub",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['EL_PRICE']"
													},
													"sink": {
														"name": "el_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MI_PRICE']"
													},
													"sink": {
														"name": "mi_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['HI_PRICE']"
													},
													"sink": {
														"name": "hi_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ETC_PRICE']"
													},
													"sink": {
														"name": "etc_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_CODE']"
													},
													"sink": {
														"name": "brand_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BRAND_TOP_PRODUCT2']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BRAND_TOP_PRODUCT2&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date,'&BRAND_CODE=',item().brand_code)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BRAND_TOP_PRODUCT2_t"
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup4",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1_copy2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select '@{variables('yyyymm')}' as REQ_DATE, unnest(ARRAY[1,2]) as DATA_GBN\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1_copy3",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup4",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup4').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "data copy_copy3",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BID_NO']"
													},
													"sink": {
														"name": "bid_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BID_NAME']"
													},
													"sink": {
														"name": "bid_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SCHOOL_NAME']"
													},
													"sink": {
														"name": "school_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA']"
													},
													"sink": {
														"name": "area",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA_SUB']"
													},
													"sink": {
														"name": "area_sub",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BASE_PRICE']"
													},
													"sink": {
														"name": "base_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_01']"
													},
													"sink": {
														"name": "brand_01",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_02']"
													},
													"sink": {
														"name": "brand_02",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_03']"
													},
													"sink": {
														"name": "brand_03",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_04']"
													},
													"sink": {
														"name": "brand_04",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_05']"
													},
													"sink": {
														"name": "brand_05",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BRAND_MS']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BRAND_MS&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_FNB_MONTH_BRAND_MS_t"
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup5",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1_copy3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select '@{variables('yyyymm')}' as REQ_DATE, unnest(ARRAY[0,1,2]) as DATA_GBN \n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1_copy4",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup5').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 5,
							"activities": [
								{
									"name": "data copy_copy4",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['COMP_NAME']"
													},
													"sink": {
														"name": "comp_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BID_CNT']"
													},
													"sink": {
														"name": "bid_cnt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SUC_CNT']"
													},
													"sink": {
														"name": "suc_cnt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SUC_RATE']"
													},
													"sink": {
														"name": "suc_rate",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BID_RESULT']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BID_RESULT&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BID_RESULT_t"
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup6",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1_copy4",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select COMP_NAME as COMP_NAME, '@{variables('yyyymm')}' as REQ_DATE, unnest(ARRAY[0,1,2]) as DATA_GBN \nfrom cd_ods.tb_fnb_MONTH_BID_RESULT_t\nwhere data_gbn = '0'\nand REQ_DATE = '@{variables('yyyymm')}'\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1_copy5",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup6",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup6').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "data copy_copy5",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "POST",
												"additionalHeaders": {
													"value": "content-type:application/x-www-form-urlencoded; charset=UTF-8\naccept:application/json\naccept-encoding:gzip, deflate",
													"type": "Expression"
												},
												"requestBody": {
													"value": "@{concat('REQ_TABLE=MONTH_BID_RESULT2&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&REQ_DATE=',item().req_date, '&DATA_GBN=',item().data_gbn, '&COMP_NAME=',item().comp_name)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['COMP_NAME']"
													},
													"sink": {
														"name": "comp_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA']"
													},
													"sink": {
														"name": "area",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA_SUB']"
													},
													"sink": {
														"name": "area_sub",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SUC_CNT']"
													},
													"sink": {
														"name": "suc_cnt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BID_RESULT2']",
											"mapComplexValuesToString": false
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": "/reqData.do"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BID_RESULT2_t"
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Lookup7",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "ForEach1_copy5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select COMP_NAME as COMP_NAME, '@{variables('yyyymm')}'  as REQ_DATE, unnest(ARRAY[0,1,2]) as DATA_GBN \nfrom cd_ods.tb_fnb_MONTH_BID_RESULT_t\nwhere data_gbn = '0'\nand REQ_DATE = '@{variables('yyyymm')}' \n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1_copy6",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup7",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup7').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "data copy_copy6",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "POST",
												"additionalHeaders": {
													"value": "content-type:application/x-www-form-urlencoded; charset=UTF-8\naccept:application/json\naccept-encoding:gzip, deflate",
													"type": "Expression"
												},
												"requestBody": {
													"value": "@{concat('REQ_TABLE=MONTH_BID_RESULT3&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&REQ_DATE=',item().req_date, '&DATA_GBN=',item().data_gbn, '&COMP_NAME=',item().comp_name)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['COMP_NAME']"
													},
													"sink": {
														"name": "comp_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_NAME']"
													},
													"sink": {
														"name": "brand_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_CODE']"
													},
													"sink": {
														"name": "brand_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BID_RESULT3']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": "/reqData.do"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BID_RESULT3_t"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pipyyyymm": {
						"type": "string"
					}
				},
				"variables": {
					"yyyymm": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Industry/외부/푸드앤비드"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FNB_MONTH_BID_RESULT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "고도몰 증분",
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select to_char(now(), 'YYYYMM') as REQ_DATE, unnest(ARRAY[0,1,2]) as DATA_GBN \n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 5,
							"activities": [
								{
									"name": "data copy",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['COMP_NAME']"
													},
													"sink": {
														"name": "comp_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BID_CNT']"
													},
													"sink": {
														"name": "bid_cnt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SUC_CNT']"
													},
													"sink": {
														"name": "suc_cnt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SUC_RATE']"
													},
													"sink": {
														"name": "suc_rate",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BID_RESULT']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BID_RESULT&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BID_RESULT_t"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Industry/외부/푸드앤비드"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FNB_MONTH_BID_RESULT2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "고도몰 증분",
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select COMP_NAME as COMP_NAME,  REQ_DATE, unnest(ARRAY[0,1,2]) as DATA_GBN \nfrom cd_ods.tb_fnb_MONTH_BID_RESULT_t\nwhere data_gbn = '0'\nand REQ_DATE = to_char(now(), 'YYYYMM')\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "data copy",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "POST",
												"additionalHeaders": {
													"value": "content-type:application/x-www-form-urlencoded; charset=UTF-8\naccept:application/json\naccept-encoding:gzip, deflate",
													"type": "Expression"
												},
												"requestBody": {
													"value": "@{concat('REQ_TABLE=MONTH_BID_RESULT2&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&REQ_DATE=',item().req_date, '&DATA_GBN=',item().data_gbn, '&COMP_NAME=',item().comp_name)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['COMP_NAME']"
													},
													"sink": {
														"name": "comp_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA']"
													},
													"sink": {
														"name": "area",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA_SUB']"
													},
													"sink": {
														"name": "area_sub",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SUC_CNT']"
													},
													"sink": {
														"name": "suc_cnt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BID_RESULT2']",
											"mapComplexValuesToString": false
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": "/reqData.do"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BID_RESULT2_t"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Industry/외부/푸드앤비드"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FNB_MONTH_BID_RESULT3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "고도몰 증분",
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select COMP_NAME as COMP_NAME, REQ_DATE, unnest(ARRAY[0,1,2]) as DATA_GBN \nfrom cd_ods.tb_fnb_MONTH_BID_RESULT_t\nwhere data_gbn = '0'\nand REQ_DATE = to_char(now(), 'YYYYMM')\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "data copy",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "POST",
												"additionalHeaders": {
													"value": "content-type:application/x-www-form-urlencoded; charset=UTF-8\naccept:application/json\naccept-encoding:gzip, deflate",
													"type": "Expression"
												},
												"requestBody": {
													"value": "@{concat('REQ_TABLE=MONTH_BID_RESULT3&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&REQ_DATE=',item().req_date, '&DATA_GBN=',item().data_gbn, '&COMP_NAME=',item().comp_name)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['COMP_NAME']"
													},
													"sink": {
														"name": "comp_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_NAME']"
													},
													"sink": {
														"name": "brand_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_CODE']"
													},
													"sink": {
														"name": "brand_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BID_RESULT3']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": "/reqData.do"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BID_RESULT3_t"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Industry/외부/푸드앤비드"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FNB_MONTH_BRAND_MS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "고도몰 증분",
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select to_char(now(), 'YYYYMM') as REQ_DATE, unnest(ARRAY[1,2]) as DATA_GBN\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "data copy",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BID_NO']"
													},
													"sink": {
														"name": "bid_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BID_NAME']"
													},
													"sink": {
														"name": "bid_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SCHOOL_NAME']"
													},
													"sink": {
														"name": "school_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA']"
													},
													"sink": {
														"name": "area",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA_SUB']"
													},
													"sink": {
														"name": "area_sub",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BASE_PRICE']"
													},
													"sink": {
														"name": "base_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_01']"
													},
													"sink": {
														"name": "brand_01",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_02']"
													},
													"sink": {
														"name": "brand_02",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_03']"
													},
													"sink": {
														"name": "brand_03",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_04']"
													},
													"sink": {
														"name": "brand_04",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_05']"
													},
													"sink": {
														"name": "brand_05",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BRAND_MS']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BRAND_MS&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_FNB_MONTH_BRAND_MS_t"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Industry/외부/푸드앤비드"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FNB_MONTH_BRAND_PRICE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "고도몰 증분",
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select to_char(now(), 'YYYYMM') as REQ_DATE, unnest(ARRAY[0,1,2]) as DATA_GBN\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "data copy",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_NAME']"
													},
													"sink": {
														"name": "brand_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['EL_PRICE']"
													},
													"sink": {
														"name": "el_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MI_PRICE']"
													},
													"sink": {
														"name": "mi_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['HI_PRICE']"
													},
													"sink": {
														"name": "hi_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ETC_PRICE']"
													},
													"sink": {
														"name": "etc_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_CODE']"
													},
													"sink": {
														"name": "brand_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BRAND_PRICE']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BRAND_PRICE&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_FNB_MONTH_BRAND_PRICE_t"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Industry/외부/푸드앤비드"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FNB_MONTH_BRAND_TOP_PRODUCT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "고도몰 증분",
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select BRAND_CODE as BRAND_CODE,  REQ_DATE, unnest(ARRAY[0,1,2,3,4,5]) as DATA_GBN \nfrom cd_ods.tb_fnb_month_brand_price_t\nwhere data_gbn = '0'\nand REQ_DATE = to_char(now(),'YYYYMM')\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "data copy",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_NAME']"
													},
													"sink": {
														"name": "brand_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MP_NAME']"
													},
													"sink": {
														"name": "mp_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_CODE']"
													},
													"sink": {
														"name": "brand_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BRAND_TOP_PRODUCT']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BRAND_TOP_PRODUCT&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date,'&BRAND_CODE=',item().brand_code)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BRAND_TOP_PRODUCT_t"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Industry/외부/푸드앤비드"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FNB_MONTH_BRAND_TOP_PRODUCT2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "고도몰 증분",
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "select BRAND_CODE as BRAND_CODE,  REQ_DATE, unnest(ARRAY[1,2]) as DATA_GBN \nfrom cd_ods.tb_fnb_month_brand_price_t\nwhere data_gbn = '0'\nand REQ_DATE = to_char(now(), 'YYYYMM')\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 10,
							"activities": [
								{
									"name": "data copy",
									"description": "data copy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.00:01:00",
										"retry": 5,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "accept:application/json",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['NO']"
													},
													"sink": {
														"name": "no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_NAME']"
													},
													"sink": {
														"name": "brand_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA']"
													},
													"sink": {
														"name": "area",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AREA_SUB']"
													},
													"sink": {
														"name": "area_sub",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TOT_PRICE']"
													},
													"sink": {
														"name": "tot_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['EL_PRICE']"
													},
													"sink": {
														"name": "el_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MI_PRICE']"
													},
													"sink": {
														"name": "mi_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['HI_PRICE']"
													},
													"sink": {
														"name": "hi_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ETC_PRICE']"
													},
													"sink": {
														"name": "etc_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRAND_CODE']"
													},
													"sink": {
														"name": "brand_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DATA_GBN']"
													},
													"sink": {
														"name": "data_gbn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['REQ_DATE']"
													},
													"sink": {
														"name": "req_date",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['MONTH_BRAND_TOP_PRODUCT2']"
										},
										"timeout": "00:01:00"
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FNB",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('reqData.do?REQ_TABLE=MONTH_BRAND_TOP_PRODUCT2&REQ_KEY=F3C12301F3811775CA1B945C33E09E34&DATA_GBN=',item().data_gbn,'&REQ_DATE=',item().req_date,'&BRAND_CODE=',item().brand_code)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": "cd_ods",
												"SinkTable": "tb_fnb_MONTH_BRAND_TOP_PRODUCT2_t"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Industry/외부/푸드앤비드"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FOODINFO_BIZCNT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "음식료품제조업업종별사업체수",
				"activities": [
					{
						"name": "API REQ INFO",
						"description": "API 호출 정보를 가져오기 위해 설정 파일에서 KEY, CODE, BEGINYEAR, ENDYEAR,CALLNAME을 읽어옵니다.",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectoryConf",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.ConfFile,'.csv')",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"description": "cdi-root / Industry / 외부 / 식품산업통계 / 음식료품 제조업 업종별 사업체수/ 위치에 항목별로 복사합니다.",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "API REQ INFO",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('API REQ INFO').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "API REQ",
									"description": "각 API 호출",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:03:00",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "$['fdmseId']"
													},
													"sink": {
														"name": "fdmseId",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseSectorNm']"
													},
													"sink": {
														"name": "fdmseSectorNm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseSectorCd']"
													},
													"sink": {
														"name": "fdmseSectorCd",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseNumberGubun']"
													},
													"sink": {
														"name": "fdmseNumberGubun",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseYear']"
													},
													"sink": {
														"name": "fdmseYear",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseNumber']"
													},
													"sink": {
														"name": "fdmseNumber",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseRatio']"
													},
													"sink": {
														"name": "fdmseRatio",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseUnit']"
													},
													"sink": {
														"name": "fdmseUnit",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_ATFIS_BIZ_SRC",
											"type": "DatasetReference",
											"parameters": {
												"Category": {
													"value": "@item().Category",
													"type": "Expression"
												},
												"BeginYear": {
													"value": "@item().BeginYear",
													"type": "Expression"
												},
												"EndYear": {
													"value": "@item().EndYear",
													"type": "Expression"
												},
												"ApiKey": {
													"value": "@item().apiKey",
													"type": "Expression"
												},
												"CallName": {
													"value": "@item().CallName",
													"type": "Expression"
												},
												"DataCode": "BUSINESS"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat(pipeline().parameters.FileName, '_', replace(item().CallName, '/', '_'),'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'), '.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Merge Data",
						"description": "cdi-root / Industry / 외부 / 식품산업통계정에 통합본을 저장합니다.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach Copy data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"maxConcurrentConnections": 1,
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
										"type": "Expression"
									},
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"maxConcurrentConnections": 1,
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 1,
							"enableSkipIncompatibleRow": true,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_', formatDateTime(addHours(utcNow(), 9), 'yyyy'),'.csv')\n\n",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "음식료품제조업업종별사업체수"
					},
					"AdlsDirectoryConf": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/conf"
					},
					"ConfFile": {
						"type": "string",
						"defaultValue": "식품산업통계정보_음식료품제조업업종별사업체수_conf"
					},
					"AdlsDirectoryOri": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/음식료품제조업업종별사업체수"
					}
				},
				"folder": {
					"name": "Industry/외부/식품산업통계정보"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-15T09:12:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FOODINFO_EMPCNT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "음식료품제조업업종별종사자수",
				"activities": [
					{
						"name": "API REQ INFO",
						"description": "API 호출 정보를 가져오기 위해 설정 파일에서 KEY, CODE, BEGINYEAR, ENDYEAR,CALLNAME을 읽어옵니다.",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectoryConf",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.ConfFile,'.csv')",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"description": "cdi-root / Industry / 외부 / 식품산업통계 / 음식료품제조업업종별종사자수/ 위치에 항목별로 복사합니다.",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "API REQ INFO",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('API REQ INFO').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "API REQ",
									"description": "각 API 호출",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:03:00",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "$['fdmseId']"
													},
													"sink": {
														"name": "fdmseId",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseSectorNm']"
													},
													"sink": {
														"name": "fdmseSectorNm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseSectorCd']"
													},
													"sink": {
														"name": "fdmseSectorCd",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseNumberGubun']"
													},
													"sink": {
														"name": "fdmseNumberGubun",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseYear']"
													},
													"sink": {
														"name": "fdmseYear",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseNumber']"
													},
													"sink": {
														"name": "fdmseNumber",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseRatio']"
													},
													"sink": {
														"name": "fdmseRatio",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseUnit']"
													},
													"sink": {
														"name": "fdmseUnit",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_ATFIS_BIZ_SRC",
											"type": "DatasetReference",
											"parameters": {
												"Category": {
													"value": "@item().Category",
													"type": "Expression"
												},
												"BeginYear": {
													"value": "@item().BeginYear",
													"type": "Expression"
												},
												"EndYear": {
													"value": "@item().EndYear",
													"type": "Expression"
												},
												"ApiKey": {
													"value": "@item().apiKey",
													"type": "Expression"
												},
												"CallName": {
													"value": "@item().CallName",
													"type": "Expression"
												},
												"DataCode": "EMPLOYEE"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat(pipeline().parameters.FileName, '_', replace(item().CallName, '/', '_'),'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'), '.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Merge Data",
						"description": "cdi-root / Industry / 외부 / 식품산업통계정에 통합본을 저장합니다.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach Copy data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"maxConcurrentConnections": 1,
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
										"type": "Expression"
									},
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"maxConcurrentConnections": 1,
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 1,
							"enableSkipIncompatibleRow": true,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_', formatDateTime(addHours(utcNow(), 9), 'yyyy'),'.csv')\n\n",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "음식료품제조업업종별종사자수"
					},
					"AdlsDirectoryConf": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/conf"
					},
					"ConfFile": {
						"type": "string",
						"defaultValue": "식품산업통계정보_음식료품제조업업종별종사자수_conf"
					},
					"AdlsDirectoryOri": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/음식료품제조업업종별종사자수"
					}
				},
				"folder": {
					"name": "Industry/외부/식품산업통계정보"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-15T09:12:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FOODINFO_MARKETSCALE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "국내식품시장규모",
				"activities": [
					{
						"name": "API REQ_copy1",
						"description": "각 API 호출",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:00",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['fdmsId']"
										},
										"sink": {
											"name": "fdmsId",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['fdmsYear']"
										},
										"sink": {
											"name": "fdmsYear",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['fdmsSectorCd']"
										},
										"sink": {
											"name": "fdmsSectorCd",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['fdmsNumber']"
										},
										"sink": {
											"name": "fdmsNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['fdmsRatio']"
										},
										"sink": {
											"name": "fdmsRatio",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['fdmsUnit']"
										},
										"sink": {
											"name": "fdmsUnit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['fdmsIndustryGubun']"
										},
										"sink": {
											"name": "fdmsIndustryGubun",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_API_ATFIS_SCALE_SRC",
								"type": "DatasetReference",
								"parameters": {
									"ApiKey": {
										"value": "@pipeline().parameters.ApiKey",
										"type": "Expression"
									},
									"BeginYear": {
										"value": "@pipeline().parameters.BeginYear",
										"type": "Expression"
									},
									"EndYear": {
										"value": "@pipeline().parameters.EndYear",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Ori Copy Data",
						"description": "cdi-root / Industry / 외부 / 식품산업통계정에 통합본을 저장합니다.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "API REQ_copy1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"maxConcurrentConnections": 1,
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
										"type": "Expression"
									},
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"maxConcurrentConnections": 1,
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 1,
							"enableSkipIncompatibleRow": true,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_', formatDateTime(addHours(utcNow(), 9), 'yyyy'),'.csv')\n\n",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "국내식품시장규모"
					},
					"AdlsDirectoryConf": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/conf"
					},
					"ConfFile": {
						"type": "string",
						"defaultValue": "식품산업통계정보_국내식품시장규모_conf"
					},
					"ApiKey": {
						"type": "string",
						"defaultValue": "jdoqB049MSLEl6kapN6Ox2w2jCv/h57g2tQt4bmGEzk="
					},
					"BeginYear": {
						"type": "string",
						"defaultValue": "2012"
					},
					"EndYear": {
						"type": "string",
						"defaultValue": "2021"
					},
					"AdlsDirectoryOri": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/국내식품시장규모"
					}
				},
				"folder": {
					"name": "Industry/외부/식품산업통계정보"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-20T01:28:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FOODINFO_MARKETSIZE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "식품원료별사용량",
				"activities": [
					{
						"name": "API REQ INFO",
						"description": "API 호출 정보를 가져오기 위해 설정 파일에서 KEY, NAME,CODE, BEGINYEAR, ENDYEAR을 읽어옵니다.",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectoryConf",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.ConfFile,'.csv')",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"description": "cdi-root / Industry / 외부 / 식품산업통계 / 식품원료별사용량/ 위치에 항목별로 복사합니다.",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "API REQ INFO",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('API REQ INFO').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "API REQ",
									"description": "각 API 호출",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "$['cnsmpYear']"
													},
													"sink": {
														"name": "cnsmpYear",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['cnsmpCd']"
													},
													"sink": {
														"name": "cnsmpCd",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['cnsmpMtralUpperNm']"
													},
													"sink": {
														"name": "cnsmpMtralUpperNm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['cnsmpMtralNm']"
													},
													"sink": {
														"name": "cnsmpMtralNm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['cnsmpTotUsgqty']"
													},
													"sink": {
														"name": "cnsmpTotUsgqty",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['cnsmpLocalusgqty']"
													},
													"sink": {
														"name": "cnsmpLocalusgqty",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['cnsmpImportUsgqty']"
													},
													"sink": {
														"name": "cnsmpImportUsgqty",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['cnsmpLocalRelimp']"
													},
													"sink": {
														"name": "cnsmpLocalRelimp",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_ATFIS_SRC",
											"type": "DatasetReference",
											"parameters": {
												"CltCode": {
													"value": "@item().CltCode",
													"type": "Expression"
												},
												"BeginYear": {
													"value": "@item().BeginYear",
													"type": "Expression"
												},
												"EndYear": {
													"value": "@item().EndYear",
													"type": "Expression"
												},
												"ApiKey": {
													"value": "@item().apiKey",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat(pipeline().parameters.FileName, '_', replace(item().NAME, '/', '_'),'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'), '.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Merge Data",
						"description": "cdi-root / Industry / 외부 / 식품산업통계정에 통합본을 저장합니다.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach Copy data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"maxConcurrentConnections": 1,
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
										"type": "Expression"
									},
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"maxConcurrentConnections": 1,
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 1,
							"enableSkipIncompatibleRow": true,
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_', formatDateTime(addHours(utcNow(), 9), 'yyyy'),'.csv')\n\n",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "식품원료별사용량"
					},
					"AdlsDirectoryConf": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/conf"
					},
					"ConfFile": {
						"type": "string",
						"defaultValue": "식품산업통계정보_식품원료별사용량_conf"
					},
					"AdlsDirectoryOri": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/식품원료별사용량"
					}
				},
				"folder": {
					"name": "Industry/외부/식품산업통계정보"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-15T09:12:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FOODINFO_SHPTAMT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "음식료품제조업업종별출하액",
				"activities": [
					{
						"name": "API REQ INFO",
						"description": "API 호출 정보를 가져오기 위해 설정 파일에서 CATEGORY, BEGINYEAR, ENDYEAR,CALLNAME을 읽어옵니다.",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectoryConf",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.ConfFile,'.csv')",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach Copy data",
						"description": "cdi-root / Industry / 외부 / 식품산업통계 / 음식료품 제조업 업종별 출하액/ 위치에 항목별로 복사합니다.",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "API REQ INFO",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('API REQ INFO').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "API REQ",
									"description": "각 API 호출",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:03:00",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "$['fdmseId']"
													},
													"sink": {
														"name": "fdmseId",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseSectorNm']"
													},
													"sink": {
														"name": "fdmseSectorNm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseSectorCd']"
													},
													"sink": {
														"name": "fdmseSectorCd",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseNumberGubun']"
													},
													"sink": {
														"name": "fdmseNumberGubun",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseYear']"
													},
													"sink": {
														"name": "fdmseYear",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseNumber']"
													},
													"sink": {
														"name": "fdmseNumber",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseRatio']"
													},
													"sink": {
														"name": "fdmseRatio",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['fdmseUnit']"
													},
													"sink": {
														"name": "fdmseUnit",
														"type": "String"
													}
												}
											]
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_ATFIS_BIZ_SRC",
											"type": "DatasetReference",
											"parameters": {
												"Category": {
													"value": "@item().Category",
													"type": "Expression"
												},
												"BeginYear": {
													"value": "@item().BeginYear",
													"type": "Expression"
												},
												"EndYear": {
													"value": "@item().EndYear",
													"type": "Expression"
												},
												"ApiKey": {
													"value": "@pipeline().parameters.Apikey",
													"type": "Expression"
												},
												"CallName": {
													"value": "@item().CallName",
													"type": "Expression"
												},
												"DataCode": {
													"value": "@pipeline().parameters.DataCode",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_ADLS_SNK",
											"type": "DatasetReference",
											"parameters": {
												"AdlsDirectory": {
													"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
													"type": "Expression"
												},
												"FileName": {
													"value": "@concat(pipeline().parameters.FileName, '_', replace(item().CallName, '/', '_'),'_',formatDateTime(addHours(utcNow(), 9), 'yyyyMMdd'), '.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Merge Data",
						"description": "cdi-root / Industry / 외부 / 식품산업통계정에 통합본을 저장합니다.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ForEach Copy data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"maxConcurrentConnections": 1,
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@concat(pipeline().parameters.AdlsDirectoryOri,'/',formatDateTime(addHours(utcNow(), 9), 'yyyy'))",
										"type": "Expression"
									},
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"maxConcurrentConnections": 1,
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"parallelCopies": 1,
							"enableSkipIncompatibleRow": true,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@pipeline().parameters.FileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DTS_ADLS_SNK",
								"type": "DatasetReference",
								"parameters": {
									"AdlsDirectory": {
										"value": "@pipeline().parameters.AdlsDirectory",
										"type": "Expression"
									},
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_', formatDateTime(addHours(utcNow(), 9), 'yyyy'),'.csv')\n\n",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"AdlsDirectory": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "음식료품제조업업종별출하액"
					},
					"AdlsDirectoryConf": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/conf"
					},
					"ConfFile": {
						"type": "string",
						"defaultValue": "식품산업통계정보_음식료품제조업업종별출하액_conf"
					},
					"AdlsDirectoryOri": {
						"type": "string",
						"defaultValue": "Industry/외부/식품산업통계정보/음식료품제조업업종별출하액"
					},
					"Apikey": {
						"type": "string",
						"defaultValue": "jdoqB049MSLEl6kapN6Ox2w2jCv/h57g2tQt4bmGEzk="
					},
					"DataCode": {
						"type": "string",
						"defaultValue": "SHIPMENT"
					}
				},
				"folder": {
					"name": "Industry/외부/식품산업통계정보"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-15T09:12:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FSK_C002')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "수요기관정보조회",
				"activities": [
					{
						"name": "sel_date",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 5,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "with vw_range as\n(\nselect generate_series(0,999) * 1000 + 1 as st, (generate_series(0,999)+1) * 1000 as ed\n)\nselect st, ed, to_char(now() - interval '1 day', 'YYYYMMDD') as chng_dt from vw_range\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "sel_date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('sel_date').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy data1_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 3,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"additionalColumns": [
												{
													"name": "st",
													"value": {
														"value": "@item().st",
														"type": "Expression"
													}
												},
												{
													"name": "ed",
													"value": {
														"value": "@item().ed",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET"
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['PRDLST_REPORT_NO']"
													},
													"sink": {
														"name": "prdlst_report_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRMS_DT']"
													},
													"sink": {
														"name": "prms_dt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['LCNS_NO']"
													},
													"sink": {
														"name": "lcns_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_NM']"
													},
													"sink": {
														"name": "prdlst_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BSSH_NM']"
													},
													"sink": {
														"name": "bssh_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_DCNM']"
													},
													"sink": {
														"name": "prdlst_dcnm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CHNG_DT']"
													},
													"sink": {
														"name": "chng_dt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RAWMTRL_NM']"
													},
													"sink": {
														"name": "rawmtrl_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['st']"
													},
													"sink": {
														"name": "st",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['ed']"
													},
													"sink": {
														"name": "ed",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['C002']['row']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FSK",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('/api/f93320322b05463499de/C002/json/',item().st,'/',item().ed,'/chng_dt=',item().chng_dt)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK_P02",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": {
													"value": "@pipeline().parameters.SinkSchema",
													"type": "Expression"
												},
												"SinkTable": {
													"value": "@pipeline().parameters.SinkTable",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "tb_fsk_C002_temp"
					}
				},
				"variables": {
					"date": {
						"type": "String"
					},
					"url": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Industry/외부/식품의약품안전처"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T07:55:39Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FSK_I0300')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "수요기관정보조회",
				"activities": [
					{
						"name": "sel_date",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 5,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "WITH vw_range AS (\n    SELECT \n        (g * 1000 + 1) AS st,\n        ((g + 1) * 1000) AS ed\n    FROM generate_series(678, 680) AS g\n)\nSELECT r.st, r.ed\nFROM vw_range r\nLEFT JOIN cd_ods.tb_fsk_I0300_temp t\n    ON r.st = CAST(t.st AS NUMERIC) AND r.ed = CAST(t.ed AS NUMERIC)\nand t.evl_yr  = '2023'\n    WHERE t.st IS null\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "sel_date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('sel_date').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 2,
							"activities": [
								{
									"name": "Copy data1_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 3,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"additionalColumns": [
												{
													"name": "st",
													"value": {
														"value": "@item().st",
														"type": "Expression"
													}
												},
												{
													"name": "ed",
													"value": {
														"value": "@item().ed",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET"
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['SITE_ADDR']"
													},
													"sink": {
														"name": "site_addr",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_REPORT_NO']"
													},
													"sink": {
														"name": "prdlst_report_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['EVL_YR']"
													},
													"sink": {
														"name": "evl_yr",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['LCNS_NO']"
													},
													"sink": {
														"name": "lcns_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_NM']"
													},
													"sink": {
														"name": "prdlst_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDCTN_QY']"
													},
													"sink": {
														"name": "prdctn_qy",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BSSH_NM']"
													},
													"sink": {
														"name": "bssh_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['H_ITEM_NM']"
													},
													"sink": {
														"name": "h_item_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['FYER_PRDCTN_ABRT_QY']"
													},
													"sink": {
														"name": "fyer_prdctn_abrt_qy",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['st']"
													},
													"sink": {
														"name": "st",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['ed']"
													},
													"sink": {
														"name": "ed",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['I0300']['row']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FSK",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('/api/f93320322b05463499de/I0300/json/',item().st,'/',item().ed,'/EVL_YR=2023')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK_P02",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": {
													"value": "@pipeline().parameters.SinkSchema",
													"type": "Expression"
												},
												"SinkTable": {
													"value": "@pipeline().parameters.SinkTable",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "tb_fsk_I0300_temp"
					}
				},
				"variables": {
					"date": {
						"type": "String"
					},
					"url": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Industry/외부/식품의약품안전처"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T07:55:39Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FSK_I0490')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "수요기관정보조회",
				"activities": [
					{
						"name": "sel_date",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 5,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "with vw_range as\n(\nselect generate_series(0,999) * 1000 + 1 as st, (generate_series(0,999)+1) * 1000 as ed\n)\nselect st, ed from vw_range\nwhere (st, ed) not in \n(\nselect cast(st as numeric), cast(ed as numeric) from cd_ods.tb_fsk_I0490_temp\n)\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "sel_date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('sel_date').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy data1_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 3,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"additionalColumns": [
												{
													"name": "st",
													"value": {
														"value": "@item().st",
														"type": "Expression"
													}
												},
												{
													"name": "ed",
													"value": {
														"value": "@item().ed",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET"
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['RTRVLPLANDOC_RTRVLMTHD']"
													},
													"sink": {
														"name": "rtrvlplandoc_rtrvlmthd",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_CD']"
													},
													"sink": {
														"name": "prdlst_cd",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RTRVLPRVNS']"
													},
													"sink": {
														"name": "rtrvlprvns",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['FRMLCUNIT']"
													},
													"sink": {
														"name": "frmlcunit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_REPORT_NO']"
													},
													"sink": {
														"name": "prdlst_report_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CRET_DTM']"
													},
													"sink": {
														"name": "cret_dtm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['LCNS_NO']"
													},
													"sink": {
														"name": "lcns_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DISTBTMLMT']"
													},
													"sink": {
														"name": "distbtmlmt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_TYPE']"
													},
													"sink": {
														"name": "prdlst_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ADDR']"
													},
													"sink": {
														"name": "addr",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BRCDNO']"
													},
													"sink": {
														"name": "brcdno",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['IMG_FILE_PATH']"
													},
													"sink": {
														"name": "img_file_path",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MNFDT']"
													},
													"sink": {
														"name": "mnfdt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDTNM']"
													},
													"sink": {
														"name": "prdtnm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_CD_NM']"
													},
													"sink": {
														"name": "prdlst_cd_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TELNO']"
													},
													"sink": {
														"name": "telno",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BSSHNM']"
													},
													"sink": {
														"name": "bsshnm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RTRVLDSUSE_SEQ']"
													},
													"sink": {
														"name": "rtrvldsuse_seq",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RTRVL_GRDCD_NM']"
													},
													"sink": {
														"name": "rtrvl_grdcd_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['st']"
													},
													"sink": {
														"name": "st",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['ed']"
													},
													"sink": {
														"name": "ed",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['I0490']['row']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FSK",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('/api/f93320322b05463499de/I0490/json/',item().st,'/',item().ed)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK_P02",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": {
													"value": "@pipeline().parameters.SinkSchema",
													"type": "Expression"
												},
												"SinkTable": {
													"value": "@pipeline().parameters.SinkTable",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "tb_fsk_I0490_temp"
					}
				},
				"variables": {
					"date": {
						"type": "String"
					},
					"url": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Industry/외부/식품의약품안전처"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T07:55:39Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PIP_API_INDUSTRY_FSK_I1250')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "수요기관정보조회",
				"activities": [
					{
						"name": "sel_date",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 5,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzurePostgreSqlSource",
								"query": {
									"value": "with vw_range as\n(\nselect generate_series(0,999) * 1000 + 1 as st, (generate_series(0,999)+1) * 1000 as ed\n)\nselect st, ed, to_char(now() - interval '1 day', 'YYYYMMDD') as chng_dt from vw_range\n;",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DTS_POSTGRESQL_SNK",
								"type": "DatasetReference",
								"parameters": {
									"SinkSchema": "1",
									"SinkTable": "1"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "sel_date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('sel_date').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy data1_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 3,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"additionalColumns": [
												{
													"name": "st",
													"value": {
														"value": "@item().st",
														"type": "Expression"
													}
												},
												{
													"name": "ed",
													"value": {
														"value": "@item().ed",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET"
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzurePostgreSQLSink",
											"writeBatchSize": 1000000,
											"writeBatchTimeout": "00:30:00",
											"writeMethod": "CopyCommand"
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['PRDLST_REPORT_NO']"
													},
													"sink": {
														"name": "prdlst_report_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRMS_DT']"
													},
													"sink": {
														"name": "prms_dt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['LAST_UPDT_DTM']"
													},
													"sink": {
														"name": "last_updt_dtm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['LCNS_NO']"
													},
													"sink": {
														"name": "lcns_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_NM']"
													},
													"sink": {
														"name": "prdlst_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['QLITY_MNTNC_TMLMT_DAYCNT']"
													},
													"sink": {
														"name": "qlity_mntnc_tmlmt_daycnt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BSSH_NM']"
													},
													"sink": {
														"name": "bssh_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRDLST_DCNM']"
													},
													"sink": {
														"name": "prdlst_dcnm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CHILD_CRTFC_YN']"
													},
													"sink": {
														"name": "child_crtfc_yn",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['INDUTY_CD_NM']"
													},
													"sink": {
														"name": "induty_cd_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DISPOS']"
													},
													"sink": {
														"name": "dispos",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['FRMLC_MTRQLT']"
													},
													"sink": {
														"name": "frmlc_mtrqlt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['USAGE']"
													},
													"sink": {
														"name": "usage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['POG_DAYCNT']"
													},
													"sink": {
														"name": "pog_daycnt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['HIENG_LNTRT_DVS_NM']"
													},
													"sink": {
														"name": "hieng_lntrt_dvs_nm",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRODUCTION']"
													},
													"sink": {
														"name": "production",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PRPOS']"
													},
													"sink": {
														"name": "prpos",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['st']"
													},
													"sink": {
														"name": "st",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['ed']"
													},
													"sink": {
														"name": "ed",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['I1250']['row']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DTS_API_FSK",
											"type": "DatasetReference",
											"parameters": {
												"url": {
													"value": "@concat('/api/f93320322b05463499de/I1250/json/',item().st,'/',item().ed,'/chng_dt=',item().chng_dt)",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DTS_POSTGRESQL_SNK_P02",
											"type": "DatasetReference",
											"parameters": {
												"SinkSchema": {
													"value": "@pipeline().parameters.SinkSchema",
													"type": "Expression"
												},
												"SinkTable": {
													"value": "@pipeline().parameters.SinkTable",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"SinkSchema": {
						"type": "string",
						"defaultValue": "cd_ods"
					},
					"SinkTable": {
						"type": "string",
						"defaultValue": "tb_fsk_I1250_temp"
					}
				},
				"variables": {
					"date": {
						"type": "String"
					},
					"url": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Industry/외부/식품의약품안전처"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T07:55:39Z"
			},
			"dependsOn": []
		}
	]
}